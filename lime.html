<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مريام</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
  <!-- Intersection Observer Polyfill for wider browser support -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/polyfill/v2/polyfill.min.js?features=IntersectionObserver"></script>
  <!-- Three.js Library (kept for potential future use, but not used in hero section) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.159.0/three.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
    
    * {
      font-family: 'Tajawal', sans-serif;
      font-size: 0.95rem; /* Slightly reduced base font size */
    }
    
    :root {
      --primary-blue: #1a1a1a; /* Darkest gray/black */
      --light-blue: #333333;  /* Dark gray */
      --medium-blue: #555555; /* Medium gray */
      --dark-blue: #777777;   /* Lighter gray */
      --header-blue-medium: #222222; /* Header dark gray */
    }
    
    .gradient-blue {
      background: linear-gradient(135deg, var(--primary-blue) 0%, var(--light-blue) 100%);
    }
    
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); /* Darker shadow */
    }
    
    .product-image {
      transition: transform 0.3s ease;
    }
    
    .product-image:hover {
      transform: scale(1.05);
    }
    
    .cart-badge {
      animation: bounce 0.5s ease;
    }
    
    @keyframes bounce {
      0%, 20%, 53%, 80%, 100% { transform: translateY(0); }
      40%, 43% { transform: translateY(-10px); }
      70% { transform: translateY(-5px); }
    }

    /* New Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.01); /* Reduced scale for subtle pulse */
      }
      100% {
        transform: scale(1);
      }
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    /* Modified glow animation for black glow */
    @keyframes glow-black {
      0%, 100% {
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
      }
      50% {
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.8); /* Reduced glow intensity */
      }
    }

    /* Original glow animation for red glow (for Shop Now button) */
    @keyframes glow-red {
      0%, 100% {
        box-shadow: 0 0 5px rgba(255, 107, 107, 0.5);
      }
      50% {
        box-shadow: 0 0 15px rgba(255, 107, 107, 0.8); /* Reduced glow intensity */
      }
    }

    /* Apply animations to elements */
    .hero-section-image-container img {
      animation: float 3s ease-in-out infinite;
    }

    .hero-section-content h1 {
      animation: slideInRight 1s ease-out;
    }

    .hero-section-content p {
      animation: slideInRight 1.2s ease-out;
    }

    /* Specific animation for the hero section button */
    .hero-section-content .animated-button.shop-now-btn {
      animation: slideInRight 1.4s ease-out, glow-red 2s ease-in-out infinite;
    }

    /* General animation for other animated buttons with black glow */
    .animated-button:not(.shop-now-btn) {
      animation: slideInRight 0.8s ease-out, glow-black 1.5s ease-in-out infinite; /* Faster slide, faster glow */
    }

    .product-card {
      transition: all 0.3s ease;
      animation: fadeInUp 0.8s ease-out;
    }

    .product-card:hover {
      animation: pulse 0.8s ease-in-out; /* Slower pulse for subtlety */
    }

    .navbar-glass {
      animation: slideInLeft 1s ease-out;
    }

    .add-to-cart:hover {
      animation: pulse 0.3s ease-in-out;
    }
    
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease;
    }
    
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .modal {
      backdrop-filter: blur(10px);
      background: rgba(0, 0, 0, 0.7); /* Darker modal background */
    }

    .modal-content {
        max-height: 90vh;
        overflow-y: auto;
    }
    
    .heart-icon {
      transition: all 0.3s ease;
    }
    
    .heart-icon:hover {
      color: #444444; /* Dark gray hover */
      transform: scale(1.2);
    }
    
    .heart-icon.liked {
      color: #444444; /* Dark gray liked */
      transform: scale(1.1);
    }
    
    .navbar-glass {
      backdrop-filter: blur(20px);
      background: var(--header-blue-medium);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      transition: background 0.3s ease-in-out;
    }

    .navbar-glass.scrolled {
      background: rgba(0, 0, 0, 0.8); /* Darker scrolled navbar */
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .store-title {
      font-family: 'Reem Kufi', sans-serif;
      font-weight: 900; /* Made bolder */
      font-size: 3rem; /* Made larger */
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      transition: all 0.3s ease;
    }
    
    /* Custom CSS for filter buttons */
    .filter-button {
      transition: all 0.3s ease;
      background-color: #333; /* Default background */
      color: #eee; /* Default text color */
      border: 1px solid #555;
    }
    
    .filter-button:hover {
      background-color: #555;
      color: #fff;
      transform: translateY(-2px); /* Slight lift on hover */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Subtle shadow on hover */
    }
    
    .filter-button.active {
      background: #000; /* Active background */
      color: white; /* Active text color */
      transform: scale(1.05); /* Slight scale on active */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4); /* Stronger shadow on active */
    }
    /* End Custom CSS for filter buttons */

    .page-section {
      display: none;
    }
    
    .page-section.active {
      display: block;
    }

    img {
      background: linear-gradient(135deg, #333 0%, #555 100%); /* Darker image placeholder */
      position: relative;
    }

    img:before {
      content: "Product Image"; /* Changed to English */
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #aaa; /* Lighter text for placeholder */
      font-size: 14px;
      text-align: center;
    }

    .cart-items-scroll {
      max-height: 400px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .option-selected {
        border-color: #000; /* Black border for selected option */
        box-shadow: 0 0 0 2px #000;
        transform: scale(1.05); /* Added animation for selected option */
        background-color: #000; /* Black background for selected option */
        color: white; /* White text for selected option */
    }
    
    /* Description text colors */
    .product-description,
    #modalProductDescription {
      color: #000000 !important; /* Dark gray */
      font-size: 0.85rem; /* Slightly smaller font size */
      line-height: 1.5;
      margin-bottom: 1rem;
      font-weight: 400;
    }

    /* Cart text colors */
    #cartItems p {
        color: #333333 !important;  /* Dark gray */
    }
    
    #cartItems .text-xs {
        color: #666 !important;     /* Medium gray */
    }

    /* Animation on scroll styles */
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(50px);
      transition: opacity 0.8s ease-out, transform 0.8s ease-out;
    }

    .animate-on-scroll.is-visible {
      opacity: 1;
      transform: translateY(0);
    }

    .animate-scale-in {
      opacity: 0;
      transform: scale(0.9);
      transition: opacity 0.8s ease-out, transform 0.8s ease-out;
    }

    .animate-scale-in.is-visible {
      opacity: 1;
      transform: scale(1);
    }

    /* Checkout Page Specific Styles */
    #checkoutPage {
      padding-top: 80px;
    }
    .checkout-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
    }
    .checkout-card {
      background-color: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      padding: 2rem;
    }
    .checkout-title {
      color: #222222; /* Dark gray */
      font-weight: 700;
      font-size: 2rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    .form-label {
      display: block;
      color: #222222; /* Dark gray */
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    .form-input {
      border: 1px solid #555; /* Medium gray border */
      border-radius: 8px;
      padding: 0.75rem;
      width: 100%;
      background-color: #fff;
      color: #000;
      transition: all 0.3s ease;
    }
    .form-input:focus {
      border-color: #222222; /* Dark gray focus */
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
      outline: none;
    }
    .order-summary-title {
      color: #222222; /* Dark gray */
      font-weight: 700;
      font-size: 1.5rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid #555; /* Medium gray border */
      padding-bottom: 0.5rem;
    }
    .order-summary-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px dashed #000000; /* Changed to black */
    }
    .order-summary-item:last-child {
      border-bottom: none;
    }
    .order-summary-item img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 8px;
      margin-left: 10px;
    }
    .order-summary-item-details {
      flex-grow: 1;
      color: #000000; /* Changed to black */
    }
    .order-summary-item-details h4 {
      font-weight: 600;
      color: #000000; /* Changed to black */
    }
    .order-summary-item-details p {
      font-size: 0.85rem;
      color: #000000; /* Changed to black */
    }
    .order-summary-total {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 1rem;
      font-size: 1.25rem;
      font-weight: 700;
      color: #008000; /* Changed to green */
    }
    .confirm-order-btn {
      background-color: #222222; /* Dark gray */
      color: white;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      display: block;
      width: 100%;
      text-align: center;
      margin-top: 2rem;
    }
    .confirm-order-btn:hover {
      background-color: #000; /* Black hover */
      transform: translateY(-2px);
    }
    .confirm-order-btn:active {
      transform: translateY(0);
    }

    /* Custom Notification Style */
    .notification-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }

    .notification-item {
      background-color: #28a745; /* Green for success */
      color: white;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      margin-bottom: 10px;
      opacity: 0;
      transform: translateY(-20px);
      transition: opacity 0.5s ease-out, transform 0.5s ease-out;
      max-width: 300px;
      text-align: center;
    }

    .notification-item.show {
      opacity: 1;
      transform: translateY(0);
    }

    .notification-item.hide {
      opacity: 0;
      transform: translateY(-20px);
    }

    .notification-item .main-message {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .notification-item .sub-message {
      font-size: 14px;
    }

    /* Style for regular (non-success) notifications */
    .notification-item.regular {
      background-color: #333333; /* Dark gray for regular messages */
    }
    /* Style for error notifications */
    .notification-item.error {
      background-color: #dc3545; /* Red for error messages */
    }

    /* Tailwind overrides for new color scheme */
    .bg-gradient-to-br {
        background: linear-gradient(135deg, #1a1a1a 0%, #333333 100%) !important;
    }
    .text-blue-400 { color: #eeeeee !important; } /* Light gray text */
    .text-blue-300 { color: #cccccc !important; } /* Lighter gray text */
    .text-blue-200 { color: #aaaaaa !important; } /* Even lighter gray text */
    .bg-blue-300 { background-color: #333333 !important; } /* Dark gray background */
    .hover\:bg-blue-400:hover { background-color: #000000 !important; } /* Black hover */
    .border-blue-100 { border-color: #555555 !important; } /* Medium gray border */
    .focus\:border-blue-200:focus { border-color: #777777 !important; } /* Lighter gray focus */
    .bg-blue-50 { background-color: #1a1a1a !important; } /* Darkest gray background */

    /* Image Gallery Styles */
    .product-gallery {
      position: relative;
      margin-bottom: 1rem;
    }

    .main-product-image {
      width: 100%;
      height: 280px; /* Slightly smaller height */
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .main-product-image:hover {
      transform: scale(1.02);
    }

    .gallery-controls {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      padding: 0 1rem;
      z-index: 10;
    }

    .gallery-btn {
      background: rgba(255, 255, 255, 0.9);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .gallery-btn:hover {
      background: white;
      transform: scale(1.1);
    }

    .gallery-btn svg {
      width: 20px;
      height: 20px;
      color: #222222; /* Dark gray */
    }

    .gallery-thumbnails {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .thumbnail {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 6px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .thumbnail:hover {
      border-color: #222222; /* Dark gray */
      transform: scale(1.05);
    }

    .thumbnail.active {
      border-color: #222222; /* Dark gray */
      box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.3);
    }

    .image-counter {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      z-index: 5;
    }

    /* Side Menu Styles */
    .side-menu {
      position: fixed;
      top: 0;
      left: -300px;
      width: 280px;
      height: 100%;
      background-color: #fff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
      z-index: 1001;
      transition: left 0.3s ease-in-out;
      padding: 20px;
      flex-direction: column;
    }

    .side-menu.open {
      left: 0;
    }

    .side-menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      display: none;
    }

    .side-menu-overlay.open {
      display: block;
    }

    .side-menu-header h3 {
      font-size: 1.8rem;
      font-weight: bold;
      color: var(--dark-blue);
    }

    .side-menu-close-btn {
      background: none;
      border: none;
      font-size: 2rem;
      color: #666;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .side-menu-close-btn:hover {
      color: var(--header-blue-medium);
    }

    .social-links a {
      display: flex;
      align-items: center;
      padding: 15px 10px;
      margin-bottom: 10px;
      background-color: var(--primary-blue);
      border-radius: 8px;
      color: var(--dark-blue);
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .social-links a:hover {
      background-color: var(--light-blue);
      color: var(--header-blue-medium);
      transform: translateX(5px);
    }

    .social-links a svg {
      margin-left: 15px;
      width: 28px;
      height: 28px;
      fill: currentColor;
    }

    /* Color option buttons */
    .color-option-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: white;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    .color-option-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.3);
    }

    .color-option-btn.option-selected {
      border-color: #000; /* Black border */
      box-shadow: 0 0 0 3px #000;
      transform: scale(1.15);
    }

    /* Specific colors for buttons */
    .color-option-btn[data-color="أسود"] { background-color: #000; }
    .color-option-btn[data-color="رمادي"] { background-color: #808080; }
    .color-option-btn[data-color="أزرق"] { background-color: #0000FF; }
    .color-option-btn[data-color="أبيض"] { background-color: #FFFFFF; color: #333; border-color: #ccc;}
    .color-option-btn[data-color="كحلي"] { background-color: #000080; }
    .color-option-btn[data-color="بيج"] { background-color: #F5F5DC; color: #333; border-color: #ccc;}
    .color-option-btn[data-color="أخضر"] { background-color: #008000; }
    .color-option-btn[data-color="بني"] { background-color: #A52A2A; }
    .color-option-btn[data-color="زيتي"] { background-color: #6B8E23; }
    .color-option-btn[data-color="متعدد"] { background-color: #ccc; color: #333; font-size: 0.7rem; }

    /* Custom CSS for black product names and prices */
    .product-card h3,
    #modalProductName {
      color: #000000 !important; /* Force black color */
    }

    /* Price in green */
    .product-card span.text-xl,
    #modalProductPrice {
      color: #008000 !important; /* Force green color */
    }

    /* Black text for Price, Availability, Sizes, Colors labels */
    .text-lg.font-semibold.text-blue-400 {
        color: #000000 !important; /* Black for Price, Availability, Sizes, Colors labels */
    }

    /* Black text for size buttons */
    #sizesContainer button {
        color: #000000 !important; /* Black for size button text */
    }

    /* Selected size/color button styling */
    #sizesContainer button.option-selected,
    #colorsContainer button.option-selected {
        background-color: #000 !important; /* Black background */
        color: white !important; /* White text */
    }

    /* Cart Modal Specific Styles */
    #cartModal h2 {
        color: #000000 !important; /* Shopping Cart title in black */
    }

    #cartItems h4 {
        color: #000000 !important; /* Product name in cart in black */
    }

    #cartItems p {
        color: #000000 !important; /* Product details in cart in black */
    }

    #cartItems button svg {
        color: #FF0000 !important; /* Remove from cart icon in red */
    }

    #cartTotal {
        color: #008000 !important; /* Cart total in green */
    }

    /* Specific style for the important note section */
    .checkout-card .bg-yellow-100 {
        background-color: #ffe0e0 !important; /* Light red background */
        border-color: #ff0000 !important; /* Red border */
        color: #ff0000 !important; /* Red text */
    }
    .checkout-card .bg-yellow-100 p {
        color: #ff0000 !important; /* Ensure paragraph text is red */
    }

    /* Checkout page delete icon color */
    #checkoutOrderSummary button svg {
        color: #FF0000 !important; /* Red for delete icon on checkout page */
    }

    /* New: Animation for add to cart button in modal */
    #modalAddToCartBtn {
        transition: all 0.1s ease-in-out; /* Faster transition for click feedback */
    }
    #modalAddToCartBtn:active {
        transform: scale(1.05);
        background-color: #000 !important; /* Black background on click */
    }

    /* New: Animation for hero image */
    .hero-image-animated {
        transition: transform 1s ease-in-out; /* Smooth transition */
        height: 250px; /* Smaller height for mobile */
        object-fit: cover; /* Ensure image covers the area */
    }
    .hero-image-animated:hover {
      transform: scale(1.02);
    }
    /* Keyframes for continuous animation */
    @keyframes heroZoom {
        0% { transform: scale(1); }
        50% { transform: scale(1.005); } /* Reduced scale for subtle zoom */
        100% { transform: scale(1); }
    }

    .hero-image-animated {
        animation: heroZoom 10s ease-in-out infinite; /* Apply continuous animation, slower */
    }

    /* Smaller font size for hero title on smaller screens */
    @media (max-width: 768px) {
      .hero-section-title {
        font-size: 2.5rem !important; /* Smaller font size for mobile */
      }
    }

    /* Custom styles for Three.js canvas (kept for reference, but not used in hero) */
    #threejs-container {
      width: 200px; /* Smaller square size */
      height: 200px; /* Smaller square size */
      border-radius: 8px; /* Keep rounded corners */
      overflow: hidden; /* Hide overflow from cube */
      margin-right: auto; /* Push to the left in RTL */
      margin-left: 0; /* Ensure no left margin */
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      display: none; /* Hide Three.js container */
    }

    /* Adjust hero section layout for the new image/three.js container */
    .hero-section-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-wrap: nowrap;
    }

    .hero-section-image-container {
      display: flex;
      justify-content: flex-end; /* Align image to the right in RTL */
      width: 100%;
    }

    @media (min-width: 768px) {
      .hero-section-content {
        align-items: flex-start; /* Align content to the left in RTL for larger screens */
        text-align: left; /* Align text to the left for RTL */
      }
      .hero-section-image-container {
        justify-content: flex-end; /* Align image to the right in RTL for larger screens */
      }
    }

    /* NEW STYLES FOR IMAGE LEFT, TEXT RIGHT */
    .hero-section-container {
      display: flex;
      flex-direction: row-reverse; /* Changed to row-reverse for image right, text left in RTL */
      gap: 12px; /* Maintain gap */
      align-items: center; /* Vertically center items */
    }

    .hero-section-image-container {
      flex: 0 0 auto; /* Don't grow, don't shrink, take content width */
      width: 200px; /* Fixed width for the image container */
      height: 200px; /* Fixed height for the image container */
      display: flex; /* Ensure flex properties apply to align image */
      justify-content: flex-start; /* Align image to the start (left) */
      align-items: flex-start; /* Align image to the top */
    }

    .hero-section-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 20px 0 0 0;
     }

    /* Adjust for smaller screens if needed */
    @media (max-width: 768px) {
      .hero-section-container {
        flex-direction: row-reverse; /* Image right, text left */
        flex-wrap: nowrap; /* Prevent wrapping */
        justify-content: flex-start; /* Align to start */
        align-items: flex-start; /* Align items to top */
        gap: 15px; /* Smaller gap for mobile */
      }
      .hero-section-image-container {
        flex: 0 0 auto; /* Don't grow or shrink */
        width: 120px; /* Smaller width for mobile */
        height: 200px; /* Smaller height for mobile - INCREASED */
        justify-content: flex-start; /* Align image to the left */
        align-items: flex-start; /* Align image to the top */
        order: 2; /* Image second */
        position: relative;
      }
      .hero-section-image-container img {
        width: 120px !important; /* Force smaller image size */
        height: 200px !important; /* Force smaller image size - INCREASED */
        border-radius: 8px;
        position: relative;
        top: 0;
        left: 25px;
      }
      .hero-section-content {
        flex: 1; /* Take remaining space */
        display: flex;
        flex-direction: column;
        align-items: flex-start; /* Align content to the left */
        text-align: left; /* Left align text */
        order: 1; /* Content first */
        margin: 15px 15px 0 0; /* Add margin from right edge */
      }
      .hero-section-content h1 {
        font-size: 1.8rem !important; /* Slightly larger title for mobile */
        margin-bottom: 8px !important; /* Less margin */
        line-height: 1.2 !important;
      }
      .hero-section-content p {
        font-size: 1rem !important; /* Slightly larger paragraph for mobile */
        margin-bottom: 12px !important; /* Less margin */
        line-height: 1.3 !important;
      }
      .hero-section-content button {
        padding: 10px 20px !important; /* Larger button padding for mobile */
        font-size: 1rem !important; /* Larger button text for mobile */
        align-self: flex-start; /* Align button to the left */
      }
    }

    /* NEW: Styles for buttons to match hero section button animation */
    .animated-button {
      animation: slideInRight 0.8s ease-out, glow-black 1.5s ease-in-out infinite; /* Default to black glow */
    }

    /* Admin Panel Specific Styles */
    #adminPanel {
      padding-top: 80px;
    }
    .admin-card {
      background-color: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      padding: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }
    .admin-title {
      color: #222222;
      font-weight: 700;
      font-size: 2rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    .admin-form-group {
      margin-bottom: 1rem;
    }
    .admin-form-label {
      display: block;
      color: #222222;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    .admin-form-input,
    .admin-form-textarea,
    .admin-form-select {
      border: 1px solid #555;
      border-radius: 8px;
      padding: 0.75rem;
      width: 100%;
      background-color: #fff;
      color: #000;
      transition: all 0.3s ease;
    }
    .admin-form-input:focus,
    .admin-form-textarea:focus,
    .admin-form-select:focus {
      border-color: #222222;
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
      outline: none;
    }
    .admin-btn {
      background-color: #222222;
      color: white;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      display: inline-block;
      margin-top: 1rem;
      cursor: pointer;
    }
    .admin-btn:hover {
      background-color: #000;
      transform: translateY(-2px);
    }
    .admin-btn-danger {
      background-color: #dc3545;
    }
    .admin-btn-danger:hover {
      background-color: #c82333;
    }
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1.5rem;
    }
    .admin-table th,
    .admin-table td {
      border: 1px solid #ddd;
      padding: 0.75rem;
      text-align: right;
    }
    .admin-table th {
      background-color: #f2f2f2;
      font-weight: bold;
      color: #333;
    }
    .admin-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    .admin-table tr:hover {
      background-color: #f1f1f1;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-white min-h-screen">
  
  <!-- Navigation Bar -->
  <nav class="fixed top-0 w-full z-50 navbar-glass" id="navbar">
    <div class="container mx-auto px-6 py-4">
      <div class="flex justify-between items-center">
        <div class="text-2xl font-bold cursor-pointer store-title" onclick="showPage('home')">مريام</div>
        
        <!-- Search Bar -->
        <div class="hidden md:flex flex-1 max-w-md mx-8">
          <div class="relative w-full">
            <input type="text" id="searchInput" placeholder="Search products..." class="w-full px-4 py-2 rounded-full border border-blue-100 focus:outline-none focus:border-blue-200 bg-white">
            <button class="absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-300">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- Cart and Menu -->
        <div class="flex items-center space-x-4 space-x-reverse">
          <button id="cartBtn" class="relative p-2 text-white hover:text-blue-100 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" 
     width="25" height="25" 
     viewBox="0 0 24 24" 
     fill="none" stroke="currentColor" 
     stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="9" cy="21" r="1"/>
  <circle cx="20" cy="21" r="1"/>
  <path d="M5 6h16l-1.5 9h-13z"/>
  <path d="M5 6L4 3H1"/>
</svg>
            <span id="cartCount" class="absolute -top-2 -right-2 bg-blue-300 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
          </button>
          
          <button id="wishlistBtn" class="relative p-2 text-white hover:text-blue-100 transition-colors" onclick="showPage('wishlist')">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
            </svg>
            <span id="wishlistCount" class="absolute -top-2 -right-2 bg-blue-300 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
          </button>

          <!-- Hamburger Menu Button -->
          <button id="hamburgerBtn" class="p-2 text-white hover:text-blue-100 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </div>
    </nav>

  <!-- Side Menu (Hidden by default) -->
  <div id="sideMenuOverlay" class="side-menu-overlay"></div>
  <div id="sideMenu" class="side-menu">
    <div class="side-menu-header">
      <h3>Contact Us</h3>
      <button id="closeSideMenu" class="side-menu-close-btn">&times;</button>
    </div>
    <div class="social-links flex-grow">
      <a href="https://www.facebook.com/yourpage" target="_blank">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.25 6 14 6c1.65 0 2.48.12 2.83.25V8h-1.66c-1.12 0-1.33.53-1.33 1.32V12h3l-.48 3H14v6.79c5.05-.5 9-4.76 9-9.79z"/></svg>
        Facebook
      </a>
      <a href="https://www.instagram.com/yourpage" target="_blank">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4c0 3.2-2.6 5.8-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8C2 4.6 4.6 2 7.8 2zm-.2 2A2.8 2.8 0 005 7.8v8.4c0 1.54 1.26 2.8 2.8 2.8h8.4a2.8 2.8 0 002.8-2.8V7.8A2.8 2.8 0 0016.2 5H7.6zm9.65 2.25a1.2 1.2 0 11-2.4 0 1.2 1.2 0 012.4 0zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zm0 2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/></svg>
        Instagram
      </a>
      <a href="https://wa.me/YOUR_PHONE_NUMBER" target="_blank">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.04 2c-5.45 0-9.91 4.46-9.91 9.91 0 1.75.5 3.45 1.46 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.45 0 9.91-4.46 9.91-9.91S17.49 2 12.04 2zm.04 1.67c4.5 0 8.24 3.74 8.24 8.24 0 4.5-3.74 8.24-8.24 8.24-1.48 0-2.9-.4-4.13-1.17l-.3-.18-3.1 1.02 1.04-3.04-.2-.32c-.8-1.28-1.22-2.75-1.22-4.25 0-4.5 3.74-8.24 8.24-8.24zm-3.2 5.27c-.2-.09-.4-.14-.6-.14-.2 0-.4.05-.6.14-.2.09-.4.2-.5.3-.1.1-.2.2-.2.4-.05.2-.05.4-.05.6s.05.4.1.6c.05.2.1.3.2.4.1.1.2.2.4.3.2.1.4.2.6.2.2 0 .4-.05.6-.14.2-.09.4-.2.5-.3.1-.1.2-.2.2-.4.05-.2.05-.4.05-.6s-.05-.4-.1-.6c-.05-.2-.1-.3-.2-.4-.1-.1-.2-.2-.4-.3zm3.2 0c-.2-.09-.4-.14-.6-.14-.2 0-.4.05-.6.14-.2.09-.4.2-.5.3-.1.1-.2.2-.2.4-.05.2-.05.4-.05.6s.05.4.1.6c.05.2.1.3.2.4.1.1.2.2.4.3.2.1.4.2.6.2.2 0 .4-.05.6-.14.2-.09.4-.2.5-.3.1-.1.2-.2.2-.4.05-.2.05-.4.05-.6s-.05-.4-.1-.6c-.05-.2-.1-.3-.2-.4-.1-.1-.2-.2-.4-.3zm3.2 0c-.2-.09-.4-.14-.6-.14-.2 0-.4.05-.6.14-.2.09-.4.2-.5.3-.1.1-.2.2-.2.4-.05.2-.05.4-.05.6s.05.4.1.6c.05.2.1.3.2.4.1.1.2.2.4.3.2.1.4.2.6.2.2 0 .4-.05.6-.14.2-.09.4-.2.5-.3.1-.1.2-.2.2-.4.05-.2.05-.4.05-.6s-.05-.4-.1-.6c-.05-.2-.1-.3-.2-.4-.1-.1-.2-.2-.4-.3z"/></svg>
        WhatsApp
      </a>
      <a href="https://www.tiktok.com/@yourpage" target="_blank">
<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  <path fill="#1a1a1a" d="M12 2c0 .7.1 1.4.3 2.1.4 1.4 1.4 2.5 2.7 3.1.6.3 1.3.4 2 .4V4.5c-.6 0-1.2-.2-1.8-.5-.8-.4-1.4-1.1-1.6-2-.1-.3-.1-.7-.1-1H12z"/>
  <path fill="444444" d="M12 2v12c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.2 0 .4 0 .6.1V9.7c-.2 0-.4-.1-.6-.1-2.8 0-5 2.2-5 5s2.2 5 5 5c2.7 0 5-2.2 5-5V8.1c.9.6 1.9.9 3 1V6.6c-.5 0-1-.1-1.5-.3-1.3-.5-2.3-1.6-2.7-3.1C12.1 2.8 12 2.4 12 2z"/>
</svg>
        TikTok
      </a>
    </div>
  </div>

  <!-- Home Page -->
  <div id="home" class="page-section active">
    <!-- Hero Section -->
    <section class="pt-20 pb-16 gradient-blue">
    <div class="flex flex-row items-start justify-between hero-section-container"> 
  <!-- الصورة شمال -->
  <div class="fade-in hero-section-image-container visible">
    <img src="https://cdn.salla.sa/DOjpl/eabf9a25-1beb-47c8-937d-e9187d3391b1-683x1000-xq2k97Eb2eM4Cjgd6VKtCVXSWgxLBhGFq2eoxgNV.jpg" 
         alt="Young man wearing stylish hoodie and sweatpants" 
         class="rounded-lg shadow-xl hero-image-animated" 
         style="width: 250px; height: 240px; margin: 20px 10px 0 0;" />
  </div>

  <!-- الكلام يمين -->
  <div class="fade-in hero-section-content text-right visible ml-6">
    <h1 class="text-4xl md:text-4xl font-bold text-blue-400 mb-4 animate-on-scroll hero-section-title is-visible">
      Trendy Hoodies &amp; Sweatpants
    </h1>
    
    <p class="text2-xl text-blue-300 mb-6 animate-on-scroll is-visible">
      Discover our exclusive collection of modern and stylish hoodies and sweatpants
    </p>
    
    <button class="bg-red-500 text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-black transition-colors animate-on-scroll mt-2 is-visible animated-button shop-now-btn" onclick="scrollToProducts()">
      Shop Now
    </button>
  </div>
</div>


    </section>

    <!-- Category Filter -->

    <!-- Category Filter -->
    <section class="py-8 bg-white">
      <div class="container mx-auto px-6">
        <div class="flex flex-wrap justify-center gap-4 animate-on-scroll">
          <button class="filter-button px-6 py-3 rounded-full border active animated-button" data-category="all">
            All Products
          </button>
          <button class="filter-button px-6 py-3 rounded-full border animated-button" data-category="hoodies">
            Hoodies
          </button>
          <button class="filter-button px-6 py-3 rounded-full border animated-button" data-category="sweatpants">
            Sweatpants
          </button>
          <button class="filter-button px-6 py-3 rounded-full border animated-button" data-category="sets">
            Sets
          </button>
          <button class="filter-button px-6 py-3 rounded-full border animated-button" data-category="jackets">
            Jackets
          </button>
        </div>
      </div>
    </section>

    <!-- Products Grid -->
    <section class="py-16" id="productsSection">
      <div class="container mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-blue-400 mb-4 animate-on-scroll">Our Featured Products</h2>
          <p class="text-blue-300 text-lg animate-on-scroll">Choose from our wide range of stylish youth apparel</p>
        </div>
        
        <div id="productsGrid" class="grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
          <!-- Product 1: Basic Hoodie -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="1"
               data-category="hoodies"
               data-sizes="S,M,L,XL,XXL"
               data-colors="أسود,رمادي,أزرق,أبيض"
               data-available="true"
               data-quantity="20"
               data-main-image="https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg"
               data-images='["https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcReHymRabsI2JRbdt1dKWo8JRr9yUs0nF5oTg&s", "https://media.6media.me/media/catalog/product/3/0/3024204_32n7-4.jpg", "https://z.nooncdn.com/products/tr:n-t_400/v1610518165/N43641047V_1.jpg"]'
               data-color-images='{"أسود": "https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg", "رمادي": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcReHymRabsI2JRbdt1dKWo8JRr9yUs0nF5oTg&amp;s", "أزرق": "https://media.6media.me/media/catalog/product/3/0/3024204_32n7-4.jpg", "أبيض": "https://z.nooncdn.com/products/tr:n-t_400/v1610518165/N43641047V_1.jpg"}'>
            <div class="relative">
              <img src="https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg" alt="Basic Hoodie" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Basic Hoodie</h3>
              <p class="product-description">Comfortable and modern hoodie, perfect for daily wear</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">300 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 2: Slim Fit Sweatpants -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="2"
               data-category="sweatpants"
               data-sizes="S,M,L,XL"
               data-colors="أسود,رمادي,كحلي"
               data-available="true"
               data-quantity="50"
               data-main-image="https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg"
               data-images='["https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg", "https://cdn.youcan.shop/stores/c023a9c7898b66b88d276331c3f34279/products/HWBdi9BPj2nUrfpOlYHT7uQLiGtDS6mAw09ByXC2.jpeg", "https://dfcdn.defacto.com.tr/6/B3345AX_25SP_NV241_03_03.jpg"]'
               data-color-images='{"أسود": "https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg", "رمادي": "https://cdn.youcan.shop/stores/c023a9c7898b66b88d276331c3f34279/products/HWBdi9BPj2nUrfpOlYHT7uQLiGtDS6mAw09ByXC2.jpeg", "كحلي": "https://dfcdn.defacto.com.tr/6/B3345AX_25SP_NV241_03_03.jpg"}'>
            <div class="relative">
              <img src="https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg" alt="Slim Fit Sweatpants" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Slim Fit Sweatpants</h3>
              <p class="product-description">Comfortable and modern sweatpants, perfect for sports or lounging</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">250 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 3: Oversized Hoodie -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="3"
               data-category="hoodies"
               data-sizes="M,L,XL,XXL"
               data-colors="بيج,أخضر,بني"
               data-available="true"
               data-quantity="30"
               data-main-image="https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&width=768"
               data-images='["https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&amp;width=768", "https://media.6media.me/media/catalog/product/8/6/8683050300812-3.jpg", "https://shechick.com/wp-content/uploads/2023/01/M11005.jpg"]'
               data-color-images='{"بيج": "https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&amp;width=768", "أخضر": "https://media.6media.me/media/catalog/product/8/6/8683050300812-3.jpg", "بني": "https://shechick.com/wp-content/uploads/2023/01/M11005.jpg"}'>
            <div class="relative">
              <img src="https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&amp;width=768" alt="Oversized Hoodie" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Oversized Hoodie</h3>
              <p class="product-description">Trendy oversized hoodie for a youthful and comfortable look</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">380 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 4: Cargo Sweatpants -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="4"
               data-category="sweatpants"
               data-sizes="S,M,L,XL"
               data-colors="أسود,زيتي,بيج"
               data-available="true"
               data-quantity="40"
               data-main-image="https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_01_02.jpg"
               data-images='["https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_01_02.jpg", "https://robeen-collection.com/upload/items/1706214839-43.jpg", "https://khotwh.com/cdn/shop/files/beige-cargo-pant-797611_736x.jpg?v=1746663242"]'
               data-color-images='{"أسود": "https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_04_03.jpg", "زيتي": "https://robeen-collection.com/upload/items/1706214839-43.jpg", "بيج": "https://khotwh.com/cdn/shop/files/beige-cargo-pant-797611_736x.jpg?v=1746663242"}'>
            <div class="relative">
              <img src="https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_01_02.jpg" alt="Cargo Sweatpants" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Cargo Sweatpants</h3>
              <p class="product-description">Practical and stylish cargo sweatpants</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">320 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 5: Zip-Up Hoodie -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="5"
               data-category="hoodies"
               data-sizes="S,M,L,XL,XXL"
               data-colors="أسود,رمادي,أبيض"
               data-available="true"
               data-quantity="25"
               data-main-image="https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg"
               data-images='["https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg", "https://cdn-images.farfetch-contents.com/26/92/98/21/26929821_56889454_600.jpg", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMxbqKVEDbKRAb0A6hEr53pxEcTR5NqAovyw&s"]'
               data-color-images='{"أسود": "https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg", "رمادي": "https://cdn-images.farfetch-contents.com/26/92/98/21/26929821_56889454_600.jpg", "أبيض": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMxbqKVEDbKRAb0A6hEr53pxEcTR5NqAovyw&s"}'>
            <div class="relative">
              <img src="https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg" alt="Zip-Up Hoodie" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Zip-Up Hoodie</h3>
              <p class="product-description">Practical full-zip hoodie, easy to wear and take off</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">350 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 7: Hoodie & Sweatpants Set -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="6"
               data-category="sets"
               data-sizes="S,M,L,XL"
               data-colors="أسود,رمادي,كحلي"
               data-available="true"
               data-quantity="15"
               data-main-image="https://m.media-amazon.com/images/I/614zok5ahvL.jpg"
               data-images='["https://m.media-amazon.com/images/I/614zok5ahvL.jpg", "https://cdn.dsmcdn.com/mnresize/600/-/ty1557/product/media/images/ty1555/prod/QC/20240919/03/739752cb-98ee-3cc9-8356-b97d248084ec/1_org_zoom.jpg", "https://images-na.ssl-images-amazon.com/images/I/41DOAxlfDfL._SL500_._AC_SL500_.jpg"]'
               data-color-images='{"أسود": "https://cdn.dsmcdn.com/mnresize/600/-/ty1557/product/media/images/ty1555/prod/QC/20240919/03/739752cb-98ee-3cc9-8356-b97d248084ec/1_org_zoom.jpg", "رمادي": "https://m.media-amazon.com/images/I/614zok5ahvL.jpg", "كحلي": "https://images-na.ssl-images-amazon.com/images/I/41DOAxlfDfL._SL500_._AC_SL500_.jpg"}'>
            <div class="relative">
              <img src="https://m.media-amazon.com/images/I/614zok5ahvL.jpg" alt="Hoodie & Sweatpants Set" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Hoodie & Sweatpants Set</h3>
              <p class="product-description">Coordinated set for a complete and comfortable youthful look</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">600 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 8: Lightweight Jacket -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="7"
               data-category="jackets"
               data-sizes="M,L,XL"
               data-colors="أسود,زيتي,رمادي"
               data-available="true"
               data-quantity="10"
               data-main-image="https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true"
               data-images='["https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSI-xvWJQPeUFTvYwHDvtPmHJIIS5-MMv6bQg&s", "https://m.media-amazon.com/images/I/41q2m5tfQfL._SY1000_.jpg"]'
               data-color-images='{"أسود": "https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true", "زيتي": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSI-xvWJQPeUFTvYHDvtPmHJIIS5-MMv6bQg&s", "رمادي": "https://m.media-amazon.com/images/I/41q2m5tfQfL._SY1000_.jpg"}'>
            <div class="relative">
              <img src="https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&amp;q=85&amp;strip=true" alt="Lightweight Jacket" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Lightweight Jacket</h3>
              <p class="product-description">Light and trendy jacket, perfect for mild days</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">450 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>

          <!-- Product 9: Graphic Hoodie -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="8"
               data-category="hoodies"
               data-sizes="S,M,L,XL"
               data-colors="أسود,أبيض,أزرق"
               data-available="false"
               data-quantity="0"
               data-main-image="https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg"
               data-images='["https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", "https://media.alshaya.com/adobe/assets/urn:aaid:aem:76e45537-a683-4a14-af96-81b3f542ded6/as/EID-258442c58379228d25a5870f6202898ed5cb4327.jpg?preferwebp=true&width=768", "https://cdn-images.farfetch-contents.com/30/86/48/48/30864848_59961396_600.jpg"]'
               data-color-images='{"أسود": "https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", "أبيض": "https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", "أزرق": "https://cdn-images.farfetch-contents.com/30/86/48/48/30864848_59961396_600.jpg"}'>
            <div class="relative">
              <img src="https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg" alt="Graphic Hoodie" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Graphic Hoodie</h3>
              <p class="product-description">Unique hoodie with a trendy graphic, adds a unique touch to your look</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">400 EGP</span>
                <button class="bg-gray-400 text-white px-4 py-2 rounded-full cursor-not-allowed" disabled>
                  Out of Stock
                </button>
              </div>
            </div>
          </div>

          <!-- Product 10: Fleece Sweatpants -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll" 
               data-id="9"
               data-category="sweatpants"
               data-sizes="M,L,XL,XXL"
               data-colors="أسود,رمادي,بني"
               data-available="true"
               data-quantity="35"
               data-main-image="https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg"
               data-images='["https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg", "https://egytar.com/wp-content/uploads/2024/05/1-5.jpg", "https://dfcdn.defacto.com.tr/7/S7370AZ_23WN_GR453_04_01.jpg", "https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true"]'
               data-color-images='{"أسود": "https://egytar.com/wp-content/uploads/2024/05/1-5.jpg", "رمادي": "https://dfcdn.defacto.0.tr/7/S7370AZ_23WN_GR453_04_01.jpg", "بني": "https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg"}'>
            <div class="relative">
              <img src="https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg" alt="Fleece Sweatpants" class="w-full h-64 object-cover product-image" />
              <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                </svg>
              </button>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-2">Fleece Sweatpants</h3>
              <p class="product-description">Warm and comfortable fleece sweatpants, perfect for winter</p>
              <div class="flex justify-between items-center">
                <span class="text-xl font-bold">300 EGP</span>
                <button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="text-center mt-12">
          <button id="loadMoreBtn" class="bg-red-500 text-white px-8 py-3 rounded-full hover:bg-red-600 transition-colors animated-button">
            Load More Products
          </button>
        </div>
      </div>
    </section>

    <!-- Featured Collection -->
    <section class="py-16 gradient-blue">
      <div class="container mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-blue-400 mb-4 animate-on-scroll">Featured Collection</h2>
          <p class="text-blue-300 text-lg animate-on-scroll">The latest trends in youth apparel this season</p>
        </div>
        
        <div class="grid md:grid-cols-3 gap-8">
          <div class="bg-white rounded-xl p-6 text-center card-hover animate-on-scroll">
            <img src="https://image.made-in-china.com/2f0j00jVdqkcNaGJbl/Fashion-Custom-Logo-Hoodie-Men-Sweatshirts-Oversized-USA-Size-Blank-Xxxxl-Hoodies.webp" alt="Hoodie Collection" class="w-full rounded-lg mb-4 animate-scale-in" />
            <h3 class="text-lg font-semibold text-blue-400 mb-2">Hoodie Collection</h3>
            <p class="text-black-300 mb-4">Hoodies with various designs and colors to suit all tastes</p>
            <button class="bg-blue-300 text-white px-6 py-2 rounded-full hover:bg-blue-400 transition-colors animated-button">
              Shop Now
            </button>
          </div>
          
          <div class="bg-white rounded-xl p-6 text-center card-hover animate-on-scroll">
            <img src="https://api.cezma.cloud/storage/thumbnails/products/web/1720305792000.jpg" alt="Sweatpants Collection" class="w-full rounded-lg mb-4 animate-scale-in" />
            <h3 class="text-lg font-semibold text-blue-400 mb-2">Sweatpants Collection</h3>
            <p class="text-black-300 mb-4">Comfortable and trendy sweatpants for a complete youthful look</p>
            <button class="bg-blue-300 text-white px-6 py-2 rounded-full hover:bg-blue-400 transition-colors animated-button">
              Shop Now
            </button>
          </div>
          
          <div class="bg-white rounded-xl p-6 text-center card-hover animate-on-scroll">
            <img src="https://echo-moda.com/wp-content/uploads/%D9%84%D9%84%D8%B9%D9%8A%D8%AF-%D8%AA%D9%86%D8%B3%D9%8A%D9%82-25-%D8%B7%D9%82%D9%85-%D9%85%D9%84%D8%A7%D8%A8%D8%B3-%D8%B4%D8%A8%D8%A7%D8%A8%D9%8A-%D8%B1%D8%A8%D9%8A%D8%B9-%D9%88%D8%B5%D9%8A%D9%81-%D8%A7%D9%84%D9%85%D9%88%D8%B3%D9%85-scaled.jpg" alt="Coordinated Sets" class="w-full rounded-lg mb-4 animate-scale-in" />
            <h3 class="text-lg font-semibold text-blue-400 mb-2">Coordinated Sets</h3>
            <p class="text-black-300 mb-4">Hoodie and sweatpants sets ready for a stylish look</p>
            <button class="bg-blue-300 text-white px-6 py-2 rounded-full hover:bg-blue-400 transition-colors animated-button">
              Shop Now
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Newsletter -->
    <section class="py-16 bg-white">
      <div class="container mx-auto px-6 text-center">
        <h2 class="text-3xl font-bold text-black-400 mb-4 animate-on-scroll">Contact Us</h2>
        <p class="text-blacl-300 mb-8 animate-on-scroll">Get the latest offers and new products</p>
        <div class="max-w-md mx-auto flex justify-center animate-on-scroll">
          <button class="bg-blue-300 text-white px-8 py-3 rounded-full hover:bg-blue-400 transition-colors animated-button">
             Send
          </button>
        </div>
      </div>
    </section>
  </div>

  <!-- Wishlist Page -->
  <div id="wishlist" class="page-section pt-20">
    <section class="py-16">
      <div class="container mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-blue-400 mb-4">Wishlist</h2>
          <p class="text-blue-300 text-lg">Products you loved</p>
        </div>
        
        <div id="wishlistGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
          <!-- Wishlist items will be displayed here -->
        </div>
        
        <div id="emptyWishlist" class="text-center py-16">
          <svg class="w-24 h-24 mx-auto text-blue-200 mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
          </svg>
          <h3 class="text-2xl font-bold text-blue-300 mb-4">Your Wishlist is Empty</h3>
          <p class="text-blue-200 mb-6">You haven't added any products to your wishlist yet</p>
          <button onclick="showPage('home')" class="bg-blue-300 text-white px-8 py-3 rounded-full hover:bg-blue-400 transition-colors animated-button">
            Shop Now
          </button>
        </div>
      </div>
    </section>
  </div>

  <!-- Cart Modal -->
  <div id="cartModal" class="fixed inset-0 z-50 hidden modal transition-all duration-300 ease-in-out transform scale-95 opacity-0">
    <div class="flex items-center justify-center min-h-screen px-4">
      <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 modal-content">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-blue-400">Shopping Cart</h2>
          <button id="closeCart" class="text-blue-300 hover:text-blue-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <div id="cartItems" class="space-y-4 mb-6 cart-items-scroll">
          <!-- Cart items will be added here -->
        </div>
        
        <div class="border-t border-blue-100 pt-4">
          <div class="flex justify-between items-center mb-4">
            <span class="text-lg font-semibold text-blue-400">Total:</span>
            <span id="cartTotal" class="text-xl font-bold text-blue-400">0 EGP</span>
          </div>
          <button id="proceedToCheckoutBtn" class="w-full bg-blue-300 text-white py-3 rounded-full hover:bg-blue-400 transition-colors animated-button">
            Proceed to Checkout
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Product Detail Modal -->
  <div id="productDetailModal" class="fixed inset-0 z-50 hidden modal">
    <div class="flex items-center justify-center min-h-screen px-4">
      <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full p-6 modal-content">
        <div class="flex justify-between items-center mb-6">
          <h2 id="modalProductName" class="text-2xl font-bold"></h2>
          <button id="closeProductDetail" class="text-blue-300 hover:text-blue-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <!-- Image Gallery -->
            <div class="product-gallery relative">
              <img id="modalProductImage" src="" alt="" class="main-product-image" />
              <div class="gallery-controls">
                <button id="prevImageBtn" class="gallery-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                  </svg>
                </button>
                <button id="nextImageBtn" class="gallery-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                  </svg>
                </button>
              </div>
              <div id="imageCounter" class="image-counter"></div>
            </div>
            <div id="galleryThumbnails" class="gallery-thumbnails">
              <!-- Thumbnails will be injected here -->
            </div>
            <p id="modalProductDescription" class="text-blue-300 text-sm mb-4"></p>
          </div>
          <div>
            <div class="mb-4">
              <span class="text-lg font-semibold text-blue-400">Price:</span>
              <span id="modalProductPrice" class="text-xl font-bold mr-2"></span>
            </div>
            <div class="mb-4">
              <span class="text-lg font-semibold text-blue-400">Availability:</span>
              <span id="modalProductAvailability" class="text-lg font-bold"></span>
            </div>

            <div id="modalProductSizes" class="mb-4">
              <p class="text-lg font-semibold text-blue-400 mb-2">Sizes:</p>
              <div id="sizesContainer" class="flex flex-wrap gap-2">
                <!-- Sizes will be injected here -->
              </div>
            </div>

            <div id="modalProductColors" class="mb-6">
              <p class="text-lg font-semibold text-blue-400 mb-2">Colors:</p>
              <div id="colorsContainer" class="flex flex-wrap gap-2">
                <!-- Colors will be injected here -->
              </div>
            </div>

            <button id="modalAddToCartBtn" class="w-full bg-blue-300 text-white py-3 rounded-full hover:bg-blue-400 transition-colors mb-3 animated-button">
              Add to Cart
            </button>
            <button id="modalRequestOrderBtn" class="w-full bg-gray-500 text-white py-3 rounded-full hover:bg-gray-600 transition-colors animated-button">
              Request Product (Currently Unavailable)
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Checkout Page -->
  <div id="checkoutPage" class="page-section hidden">
    <div class="container mx-auto px-6 py-12">
      <div class="checkout-card">
        <h2 class="checkout-title">إتمام الشراء</h2>
        
        <!-- Important Note for Checkout -->
        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6" role="alert">
          <p class="font-bold">ملاحظة هامة:</p>
          <p>يرجى التأكد من صحة جميع البيانات المدخلة (الاسم، أرقام الهواتف، العنوان) حيث سيتم التواصل معكم بناءً عليها لتأكيد الطلب وتفاصيل الشحن.</p>
        </div>

        <div class="grid md:grid-cols-2 gap-8 mt-8">
          <!-- Customer Information Form -->
          <div>
            <h3 class="order-summary-title">بيانات العميل</h3>
            <form id="checkoutForm" class="space-y-4">
              <div class="form-group">
                <label for="fullName" class="form-label">الاسم الكامل:</label>
                <input type="text" id="fullName" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="phone1" class="form-label">رقم الهاتف 1:</label>
                <input type="tel" id="phone1" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="phone2" class="form-label">رقم الهاتف 2 (اختياري):</label>
                <input type="tel" id="phone2" class="form-input">
              </div>
              <div class="form-group">
                <label for="address" class="form-label">العنوان كاملاً:</label>
                <textarea id="address" class="form-input h-24 resize-none" required></textarea>
              </div>
            </form>
          </div>

          <!-- Order Summary -->
          <div>
            <h3 class="order-summary-title">ملخص الطلب</h3>
            <div id="checkoutOrderSummary" class="space-y-2">
              <!-- Cart items will be loaded here -->
            </div>
            <div id="checkoutTotal" class="order-summary-total">
              <span>المجموع الكلي:</span>
              <span>0 جنيه</span>
            </div>
            <button id="confirmOrderBtn" class="confirm-order-btn animated-button">تأكيد الطلب</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Panel (New Section) -->
  <div id="adminPanel" class="page-section hidden">
    <div class="container mx-auto px-6 py-12">
      <div class="admin-card">
        <h2 class="admin-title">لوحة تحكم المنتجات</h2>

        <!-- Admin Login Form -->
        <div id="adminLoginForm" class="mb-8">
          <h3 class="text-xl font-bold mb-4">تسجيل الدخول للوحة الإدارة</h3>
          <div class="admin-form-group">
            <label for="adminUsername" class="admin-form-label">اسم المستخدم:</label>
            <input type="text" id="adminUsername" class="admin-form-input" required>
          </div>
          <div class="admin-form-group">
            <label for="adminPassword" class="admin-form-label">كلمة المرور:</label>
            <input type="password" id="adminPassword" class="admin-form-input" required>
          </div>
          <button id="adminLoginBtn" class="admin-btn">تسجيل الدخول</button>
        </div>

        <!-- Product Management Section (hidden until logged in) -->
        <div id="productManagementSection" class="hidden">
          <!-- Add/Edit Product Form -->
          <h3 class="text-xl font-bold mb-4">إضافة / تعديل منتج</h3>
          <form id="productForm" class="space-y-4">
            <input type="hidden" id="productId">
            <div class="admin-form-group">
              <label for="productName" class="admin-form-label">اسم المنتج:</label>
              <input type="text" id="productName" class="admin-form-input" required>
            </div>
            <div class="admin-form-group">
              <label for="productPrice" class="admin-form-label">السعر (EGP):</label>
              <input type="number" id="productPrice" class="admin-form-input" required>
            </div>
            <div class="admin-form-group">
              <label for="productDescription" class="admin-form-label">الوصف:</label>
              <textarea id="productDescription" class="admin-form-textarea" rows="3"></textarea>
            </div>
            <div class="admin-form-group">
              <label for="productCategory" class="admin-form-label">الفئة:</label>
              <select id="productCategory" class="admin-form-select" required>
                <option value="hoodies">Hoodies</option>
                <option value="sweatpants">Sweatpants</option>
                <option value="sets">Sets</option>
                <option value="jackets">Jackets</option>
              </select>
            </div>
            <div class="admin-form-group">
              <label for="productSizes" class="admin-form-label">المقاسات (افصل بفاصلة):</label>
              <input type="text" id="productSizes" class="admin-form-input" placeholder="S,M,L,XL">
            </div>
            <div class="admin-form-group">
              <label for="productColors" class="admin-form-label">الألوان (افصل بفاصلة):</label>
              <input type="text" id="productColors" class="admin-form-input" placeholder="أسود,رمادي,أزرق">
            </div>
            <div class="admin-form-group">
              <label for="productMainImage" class="admin-form-label">الصورة الأساسية لبطاقة المنتج (URL):</label>
              <input type="url" id="productMainImage" class="admin-form-input" placeholder="https://example.com/main_image.jpg" required>
            </div>
            <div class="admin-form-group">
              <label for="productImages" class="admin-form-label">روابط صور المعرض (افصل بفاصلة):</label>
              <textarea id="productImages" class="admin-form-textarea" rows="3" placeholder="url1,url2,url3"></textarea>
              <p class="text-sm text-gray-600 mt-1">هذه الصور ستظهر في معرض الصور داخل صفحة تفاصيل المنتج.</p>
            </div>
            <div class="admin-form-group">
              <label for="productColorImages" class="admin-form-label">روابط صور الألوان (JSON):</label>
              <textarea id="productColorImages" class="admin-form-textarea" rows="3" placeholder='{"أسود": "url_black", "رمادي": "url_gray"}'></textarea>
              <p class="text-sm text-gray-600 mt-1">مثال: `{"أسود": "url_black", "رمادي": "url_gray"}`. يجب أن تتطابق أسماء الألوان مع ما تم إدخاله في حقل "الألوان".</p>
            </div>
            <div class="admin-form-group">
              <label for="productQuantity" class="admin-form-label">الكمية:</label>
              <input type="number" id="productQuantity" class="admin-form-input" required>
            </div>
            <div class="admin-form-group flex items-center">
              <input type="checkbox" id="productAvailable" class="ml-2">
              <label for="productAvailable" class="admin-form-label mb-0">متاح للبيع</label>
            </div>
            <button type="submit" class="admin-btn">حفظ المنتج</button>
            <button type="button" id="clearFormBtn" class="admin-btn admin-btn-danger">مسح النموذج</button>
          </form>

          <!-- Products List -->
          <h3 class="text-xl font-bold mt-8 mb-4">قائمة المنتجات</h3>
          <div class="overflow-x-auto">
              <table class="admin-table">
                  <thead>
                      <tr>
                          <th>ID</th>
                          <th>الاسم</th>
                          <th>السعر</th>
                          <th>الفئة</th>
                          <th>الكمية</th>
                          <th>متاح</th>
                          <th>الإجراءات</th>
                      </tr>
                  </thead>
                  <tbody id="adminProductsTableBody">
                      <!-- Products will be loaded here by JavaScript -->
                  </tbody>
              </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-blue-50 py-12">
    <div class="container mx-auto px-6">
      <div class="grid md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-2xl font-bold text-blue-400 mb-4">مريام</h3>
          <p class="text-blue-300 mb-4">Your first destination for modern and stylish youth apparel</p>
          <div class="flex space-x-4 space-x-reverse">
            <a href="#" class="text-blue-300 hover:text-blue-400">
              <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
              </svg>
            </a>
            <a href="#" class="text-blue-300 hover:text-blue-400">
              <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                <path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 01-1.93.07 4.28 4.28 0 004 2.98 8.521 8.521 0 01-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
              </svg>
            </a>
            <a href="#" class="text-blue-300 hover:text-blue-400">
              <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.410 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.748-1.378 0 0-.599 2.282-.744 2.840-.282 1.084-1.064 2.456-1.549 3.235C9.584 23.815 10.77 24.001 12.017 24.001c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001 12.017.001z"/>
              </svg>
            </a>
          </div>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold text-blue-400 mb-4">Quick Links</h4>
          <ul class="space-y-2 text-blue-300">
            <li><a href="#" class="hover:text-blue-400 transition-colors">Home</a></li>
            <li><a href="#" class="hover:text-blue-400 transition-colors">Products</a></li>
            <li><a href="#" class="hover:text-blue-400 transition-colors">About Us</a></li>
            <li><a href="#" class="hover:text-blue-400 transition-colors">Contact</a></li>
          </ul>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold text-blue-400 mb-4">Categories</h4>
          <ul class="space-y-2 text-blue-300">
            <li>Hoodies</li>
            <li>Sweatpants</li>
            <li>Sets</li>
            <li>Jackets</li>
          </ul>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold text-blue-400 mb-4">Customer Service</h4>
          <ul class="space-y-2 text-blue-300">
            <li>Support</li>
            <li>Return Policy</li>
            <li>Shipping & Delivery</li>
            <li>Secure Payment</li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-blue-100 mt-8 pt-8 text-center text-blue-300">
        <p>© 2025 مريام Store. All rights reserved.</p>
        <!-- Admin Panel Button - Moved to Footer -->
        <button id="adminPanelBtn" class="mt-4 p-2 text-white hover:text-blue-100 transition-colors inline-block" onclick="showPage('adminPanel')">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.6-.365 1.33-.566 2.06-.566z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span class="block text-xs">Admin Panel</span>
        </button>
      </div>
    </div>
  </footer>

  <script>
    // Global variables
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    let cartCount = cart.length;
    let wishlistCount = wishlist.length;
    let currentProduct = null;
    let selectedSize = null;
    let selectedColor = null;
    let currentImageIndex = 0; // To track current image in gallery
    let previousScrollPosition = 0; // To store scroll position before opening modal

    // ** Telegram Bot Configuration **
    // Replace with your actual bot token and chat ID
    const TELEGRAM_BOT_TOKEN = '8454738651:AAGGc4Fa5ONWwBikkms7AVYg6xZdgsviitU'; 
    const TELEGRAM_CHAT_ID = '5375896204';     

    // Admin credentials (NOT SECURE FOR PRODUCTION)
    const ADMIN_USERNAME = 'darkstorm';
    const ADMIN_PASSWORD = 'darkstorm';

    // NEW: Admin Device Management
    const MAX_ADMIN_DEVICES = 3;
    const ADMIN_DEVICE_KEY = 'admin_device_id';
    const ALLOWED_ADMIN_DEVICES_KEY = 'allowed_admin_devices';

    // Function to generate a unique device ID
    function generateDeviceId() {
        return 'device_' + Math.random().toString(36).substr(2, 9);
    }

    // Function to get current device ID
    function getCurrentDeviceId() {
        let deviceId = localStorage.getItem(ADMIN_DEVICE_KEY);
        if (!deviceId) {
            deviceId = generateDeviceId();
            localStorage.setItem(ADMIN_DEVICE_KEY, deviceId);
        }
        return deviceId;
    }

    // Function to get allowed device IDs
    function getAllowedAdminDevices() {
        const devices = localStorage.getItem(ALLOWED_ADMIN_DEVICES_KEY);
        return devices ? JSON.parse(devices) : [];
    }

    // Function to set allowed device IDs
    function setAllowedAdminDevices(devices) {
        localStorage.setItem(ALLOWED_ADMIN_DEVICES_KEY, JSON.stringify(devices));
    }

    // Function to show a specific page and hide others
    function showPage(pageId) {
      document.querySelectorAll('.page-section').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(pageId).classList.add('active');
      // Close any open modals when switching pages
      document.getElementById('cartModal').classList.add('hidden');
      document.getElementById('productDetailModal').classList.add('hidden');

      // If navigating to admin panel, handle login state
      if (pageId === 'adminPanel') {
        checkAdminLoginState(); // NEW: Check login state
      } else if (pageId === 'home') { // NEW: Re-render products when returning to home
        renderProducts();
        initIntersectionObserver(); // NEW: Re-initialize observer for home page
      }
    }

    // NEW: Function to check admin login state
    function checkAdminLoginState() {
      const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
      const adminLoginForm = document.getElementById('adminLoginForm');
      const productManagementSection = document.getElementById('productManagementSection');
      const currentDeviceId = getCurrentDeviceId();
      const allowedDevices = getAllowedAdminDevices();

      if (isLoggedIn && allowedDevices.includes(currentDeviceId)) {
        adminLoginForm.classList.add('hidden');
        productManagementSection.classList.remove('hidden');
        renderAdminProducts();
        clearProductForm();
      } else {
        adminLoginForm.classList.remove('hidden');
        productManagementSection.classList.add('hidden');
        document.getElementById('adminUsername').value = '';
        document.getElementById('adminPassword').value = '';
        // If not logged in or device not allowed, ensure adminLoggedIn is false
        localStorage.setItem('adminLoggedIn', 'false'); 
      }
    }

    // NEW: Function to handle admin login
    function handleAdminLogin() {
      const usernameInput = document.getElementById('adminUsername').value;
      const passwordInput = document.getElementById('adminPassword').value;
      const currentDeviceId = getCurrentDeviceId();
      let allowedDevices = getAllowedAdminDevices();

      if (usernameInput === ADMIN_USERNAME && passwordInput === ADMIN_PASSWORD) {
        if (allowedDevices.includes(currentDeviceId)) {
            // Device already allowed, just log in
            localStorage.setItem('adminLoggedIn', 'true');
            showNotification('تم تسجيل الدخول بنجاح إلى لوحة الإدارة!', true);
            checkAdminLoginState();
        } else if (allowedDevices.length < MAX_ADMIN_DEVICES) {
            // Add new device to allowed list
            allowedDevices.push(currentDeviceId);
            setAllowedAdminDevices(allowedDevices);
            localStorage.setItem('adminLoggedIn', 'true');
            showNotification('تم تسجيل الدخول بنجاح إلى لوحة الإدارة! تم اعتماد هذا الجهاز.', true);
            checkAdminLoginState();
        } else {
            showNotification(`لا يمكن تسجيل الدخول. لقد وصلت إلى الحد الأقصى للأجهزة المسموح بها (${MAX_ADMIN_DEVICES}).`, false, true);
            localStorage.setItem('adminLoggedIn', 'false'); // Ensure not logged in
        }
      } else {
        showNotification('اسم المستخدم أو كلمة المرور غير صحيحة.', false, true);
        localStorage.setItem('adminLoggedIn', 'false'); // Ensure not logged in
      }
    }

    // Initial products data (extracted from HTML for easier management)
    const defaultProductsData = [
        {
            id: 1,
            name: "Basic Hoodie",
            price: 300,
            description: "Comfortable and modern hoodie, perfect for daily wear",
            category: "hoodies",
            sizes: ["S", "M", "L", "XL", "XXL"],
            colors: ["أسود", "رمادي", "أزرق", "أبيض"],
            available: true,
            quantity: 20,
            mainImage: "https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg", // Added mainImage
            images: ["https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcReHymRabsI2JRbdt1dKWo8JRr9yUs0nF5oTg&s", "https://media.6media.me/media/catalog/product/3/0/3024204_32n7-4.jpg", "https://z.nooncdn.com/products/tr:n-t_400/v1610518165/N43641047V_1.jpg"],
            colorImages: {"أسود": "https://cdn-images.farfetch-contents.com/27/48/39/46/27483946_57262455_600.jpg", "رمادي": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcReHymRabsI2JRbdt1dKWo8JRr9yUs0nF5oTg&s", "أزرق": "https://media.6media.me/media/catalog/product/3/0/3024204_32n7-4.jpg", "أبيض": "https://z.nooncdn.com/products/tr:n-t_400/v1610518165/N43641047V_1.jpg"}
        },
        {
            id: 2,
            name: "Slim Fit Sweatpants",
            price: 250,
            description: "Comfortable and modern sweatpants, perfect for sports or lounging",
            category: "sweatpants",
            sizes: ["S", "M", "L", "XL"],
            colors: ["أسود", "رمادي", "كحلي"],
            available: true,
            quantity: 50,
            mainImage: "https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg", // Added mainImage
            images: ["https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg", "https://cdn.youcan.shop/stores/c023a9c7898b66b88d276331c3f34279/products/HWBdi9BPj2nUrfpOlYHT7uQLiGtDS6mAw09ByXC2.jpeg", "https://dfcdn.defacto.com.tr/6/B3345AX_25SP_NV241_03_03.jpg"],
            colorImages: {"أسود": "https://dfcdn.defacto.com.tr/6/E5976AX_25SP_BK81_04_03.jpg", "رمادي": "https://cdn.youcan.shop/stores/c023a9c7898b66b88d276331c3f34279/products/HWBdi9BPj2nUrfpOlYHT7uQLiGtDS6mAw09ByXC2.jpeg", "كحلي": "https://dfcdn.defacto.com.tr/6/B3345AX_25SP_NV241_03_03.jpg"}
        },
        {
            id: 3,
            name: "Oversized Hoodie",
            price: 380,
            description: "Trendy oversized hoodie for a youthful and comfortable look",
            category: "hoodies",
            sizes: ["M", "L", "XL", "XXL"],
            colors: ["بيج", "أخضر", "بني"],
            available: true,
            quantity: 30,
            mainImage: "https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&width=768", // Added mainImage
            images: ["https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&width=768", "https://media.6media.me/media/catalog/product/8/6/8683050300812-3.jpg", "https://shechick.com/wp-content/uploads/2023/01/M11005.jpg"],
            colorImages: {"بيج": "https://media.alshaya.com/adobe/assets/urn:aaid:aem:ee649a46-e9a2-48f9-8ff9-559b6b239ae0/as/EID-26e523b49d13527ad3947fca5667cbc45de6a69b.jpg?preferwebp=true&width=768", "أخضر": "https://media.6media.me/media/catalog/product/8/6/8683050300812-3.jpg", "بني": "https://shechick.com/wp-content/uploads/2023/01/M11005.jpg"}
        },
        {
            id: 4,
            name: "Cargo Sweatpants",
            price: 320,
            description: "Practical and stylish cargo sweatpants",
            category: "sweatpants",
            sizes: ["S", "M", "L", "XL"],
            colors: ["أسود", "زيتي", "بيج"],
            available: true,
            quantity: 40,
            mainImage: "https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_01_02.jpg", // Added mainImage
            images: ["https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_01_02.jpg", "https://robeen-collection.com/upload/items/1706214839-43.jpg", "https://khotwh.com/cdn/shop/files/beige-cargo-pant-797611_736x.jpg?v=1746663242"],
            colorImages: {"أسود": "https://dfcdn.defacto.com.tr/6/B4377AX_24SP_BK81_04_03.jpg", "زيتي": "https://robeen-collection.com/upload/items/1706214839-43.jpg", "بيج": "https://khotwh.com/cdn/shop/files/beige-cargo-pant-797611_736x.jpg?v=1746663242"}
        },
        {
            id: 5,
            name: "Zip-Up Hoodie",
            price: 350,
            description: "Practical full-zip hoodie, easy to wear and take off",
            category: "hoodies",
            sizes: ["S", "M", "L", "XL", "XXL"],
            colors: ["أسود", "رمادي", "أبيض"],
            available: true,
            quantity: 25,
            mainImage: "https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg", // Added mainImage
            images: ["https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg", "https://cdn-images.farfetch-contents.com/26/92/98/21/26929821_56889454_600.jpg", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMxbqKVEDbKRAb0A6hEr53pxEcTR5NqAovyw&s"],
            colorImages: {"أسود": "https://media.6media.me/media/catalog/product/a/0/a09240000-1.jpg", "رمادي": "https://cdn-images.farfetch-contents.com/26/92/98/21/26929821_56889454_600.jpg", "أبيض": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMxbqKVEDbKRAb0A6hEr53pxEcTR5NqAovyw&s"}
        },
        {
            id: 6,
            name: "Hoodie & Sweatpants Set",
            price: 600,
            description: "Coordinated set for a complete and comfortable youthful look",
            category: "sets",
            sizes: ["S", "M", "L", "XL"],
            colors: ["أسود", "رمادي", "كحلي"],
            available: true,
            quantity: 15,
            mainImage: "https://m.media-amazon.com/images/I/614zok5ahvL.jpg", // Added mainImage
            images: ["https://m.media-amazon.com/images/I/614zok5ahvL.jpg", "https://cdn.dsmcdn.com/mnresize/600/-/ty1557/product/media/images/ty1555/prod/QC/20240919/03/739752cb-98ee-3cc9-8356-b97d248084ec/1_org_zoom.jpg", "https://images-na.ssl-images-amazon.com/images/I/41DOAxlfDfL._SL500_._AC_SL500_.jpg"],
            colorImages: {"أسود": "https://cdn.dsmcdn.com/mnresize/600/-/ty1557/product/media/images/ty1555/prod/QC/20240919/03/739752cb-98ee-3cc9-8356-b97d248084ec/1_org_zoom.jpg", "رمادي": "https://m.media-amazon.com/images/I/614zok5ahvL.jpg", "كحلي": "https://images-na.ssl-images-amazon.com/images/I/41DOAxlfDfL._SL500_._AC_SL500_.jpg"}
        },
        {
            id: 7,
            name: "Lightweight Jacket",
            price: 450,
            description: "Light and trendy jacket, perfect for mild days",
            category: "jackets",
            sizes: ["M", "L", "XL"],
            colors: ["أسود", "زيتي", "رمادي"],
            available: true,
            quantity: 10,
            mainImage: "https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true", // Added mainImage
            images: ["https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSI-xvWJQPeUFTvYwHDvtPmHJIIS5-MMv6bQg&s", "https://m.media-amazon.com/images/I/41q2m5tfQfL._SY1000_.jpg"],
            colorImages: {"أسود": "https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true", "زيتي": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSI-xvWJQPeUFTvYHDvtPmHJIIS5-MMv6bQg&s", "رمادي": "https://m.media-amazon.com/images/I/41q2m5tfQfL._SY1000_.jpg"}
        },
        {
            id: 8,
            name: "Graphic Hoodie",
            price: 400,
            description: "Unique hoodie with a trendy graphic, adds a unique touch to your look",
            category: "hoodies",
            sizes: ["S", "M", "L", "XL"],
            colors: ["أسود", "أبيض", "أزرق"],
            available: false,
            quantity: 0,
            mainImage: "https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", // Added mainImage
            images: ["https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", "https://media.alshaya.com/adobe/assets/urn:aaid:aem:76e45537-a683-4a14-af96-81b3f542ded6/as/EID-258442c58379228d25a5870f6202898ed5cb4327.jpg?preferwebp=true&width=768", "https://cdn-images.farfetch-contents.com/30/86/48/48/30864848_59961396_600.jpg"],
            colorImages: {"أسود": "https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", "أبيض": "https://cdn-images.farfetch-contents.com/28/90/01/22/28900122_58207630_600.jpg", "أزرق": "https://cdn-images.farfetch-contents.com/30/86/48/48/30864848_59961396_600.jpg"}
        },
        {
            id: 9,
            name: "Fleece Sweatpants",
            price: 300,
            description: "Warm and comfortable fleece sweatpants, perfect for winter",
            category: "sweatpants",
            sizes: ["M", "L", "XL", "XXL"],
            colors: ["أسود", "رمادي", "بني"],
            available: true,
            quantity: 35,
            mainImage: "https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg", // Added mainImage
            images: ["https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg", "https://egytar.com/wp-content/uploads/2024/05/1-5.jpg", "https://dfcdn.defacto.com.tr/7/S7370AZ_23WN_GR453_04_01.jpg", "https://www.versace.com/dw/image/v2/BGWN_PRD/on/demandware.static/-/Sites-ver-master-catalog/default/dw3e2fdb1a/original/90_1013537-1A09785_1B000_10_BaroccoLightPufferJacket-Jackets-Versace-online-store_0_5.jpg?sw=850&q=85&strip=true"],
            colorImages: {"أسود": "https://egytar.com/wp-content/uploads/2024/05/1-5.jpg", "رمادي": "https://dfcdn.defacto.com.tr/7/S7370AZ_23WN_GR453_04_01.jpg", "بني": "https://dfcdn.defacto.com.tr/7/D3206A8_24WN_BN569_04_03.jpg"}
        }
    ];

    // Load productsData from localStorage, or use default if not found
    let productsData = JSON.parse(localStorage.getItem('productsData')) || defaultProductsData;

    // Function to render products on the main page
    function renderProducts() {
        const productsGrid = document.getElementById('productsGrid');
        productsGrid.innerHTML = ''; // Clear existing products

        productsData.forEach(product => {
            const productCard = document.createElement('div');
            productCard.className = `bg-white rounded-xl shadow-lg overflow-hidden card-hover product-card animate-on-scroll`;
            productCard.setAttribute('data-id', product.id);
            productCard.setAttribute('data-category', product.category);
            productCard.setAttribute('data-sizes', product.sizes.join(','));
            productCard.setAttribute('data-colors', product.colors.join(','));
            productCard.setAttribute('data-available', product.available);
            productCard.setAttribute('data-quantity', product.quantity);
            // Ensure images and colorImages are stringified JSON for data attributes
            productCard.setAttribute('data-main-image', product.mainImage || (product.images && product.images.length > 0 ? product.images[0] : '')); // Use mainImage or first image
            productCard.setAttribute('data-images', JSON.stringify(product.images));
            productCard.setAttribute('data-color-images', JSON.stringify(product.colorImages));

            // Use the mainImage for the card display
            const cardImageSrc = product.mainImage || (product.images && product.images.length > 0 ? product.images[0] : '');

            productCard.innerHTML = `
                <div class="relative">
                    <img src="${cardImageSrc}" alt="${product.name}" class="w-full h-64 object-cover product-image" />
                    <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon" onclick="toggleWishlist(this)">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                        </svg>
                    </button>
                </div>
                <div class="p-6">
                    <h3 class="text-lg font-semibold mb-2">${product.name}</h3>
                    <p class="product-description">${product.description}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-bold">${product.price} EGP</span>
                        ${product.available && product.quantity > 0 ? 
                            `<button class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors add-to-cart animated-button">
                                Add to Cart
                            </button>` :
                            `<button class="bg-gray-400 text-white px-4 py-2 rounded-full cursor-not-allowed" disabled>
                                Out of Stock
                            </button>`
                        }
                    </div>
                </div>
            `;
            productsGrid.appendChild(productCard);
        });

        // Re-initialize event listeners for newly rendered products
        initAddToCartListeners();
        initWishlistItems();
        document.querySelectorAll('.product-card').forEach(card => {
            card.addEventListener('click', function(e) {
                if (e.target.closest('.add-to-cart') || e.target.closest('.heart-icon')) {
                    return;
                }
                openProductDetailModal(this);
            });
        });
    }

    // Function to initialize Intersection Observer
    let productObserver; // Declare a global variable for the observer
    function initIntersectionObserver() {
      const animateElements = document.querySelectorAll('.animate-on-scroll, .animate-scale-in');

      const observerOptions = {
        root: null, // relative to the viewport
        rootMargin: '0px',
        threshold: 0.1 // 10% of the element must be visible
      };

      // Disconnect previous observer if it exists
      if (productObserver) {
        productObserver.disconnect();
      }

      productObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target); // Stop observing once visible
          }
        });
      }, observerOptions);

      animateElements.forEach(element => {
        productObserver.observe(element);
      });
    }


    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      renderProducts(); // Render products from productsData
      updateCartDisplay();
      updateWishlistDisplay();
      updateWishlistPage();
      
      setTimeout(() => {
        document.querySelectorAll('.fade-in').forEach(element => {
          element.classList.add('visible');
        });
      }, 100);
      
      initAddToCartListeners();
      initFilterButtons();
      initWishlistItems();
      initIntersectionObserver(); // Call it here initially

      // Header scroll effect
      window.addEventListener('scroll', function() {
        const navbar = document.getElementById('navbar');
        if (window.scrollY > 50) {
          navbar.classList.add('scrolled');
        } else {
          navbar.classList.remove('scrolled');
        }
      });

      // Close product detail modal
      document.getElementById('closeProductDetail').addEventListener('click', function() {
        closeProductDetailModal();
        showPage('home'); // Always return to home page
      });

      // Add to cart from product detail modal
      document.getElementById('modalAddToCartBtn').addEventListener('click', function() {
        if (currentProduct && currentProduct.available && currentProduct.quantity > 0) {
            // Determine if options are truly required for this product
            const requiresSize = currentProduct.sizes.length > 0 && currentProduct.sizes[0] !== 'مقاس واحد';
            const requiresColor = currentProduct.colors.length > 0 && currentProduct.colors[0] !== 'متعدد';

            if (requiresSize && !selectedSize) {
                showNotification('Please select a size first.');
                return;
            }
            if (requiresColor && !selectedColor) {
                showNotification('Please select a color first.');
                return;
            }

            const productToAdd = {
                name: currentProduct.name,
                price: currentProduct.price,
                // Use the currently displayed image (either from gallery or color-specific)
                image: document.getElementById('modalProductImage').src, 
                description: currentProduct.description,
                size: selectedSize || (requiresSize ? '' : 'مقاس واحد'), // Use selected or default
                color: selectedColor || (requiresColor ? '' : 'متعدد'), // Use selected or default
                colorImage: (selectedColor && currentProduct.colorImages && currentProduct.colorImages[selectedColor]) ? currentProduct.colorImages[selectedColor] : null, // New: Store selected color image
                id: Date.now()
            };
            
            cart.push(productToAdd);
            cartCount++;
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
            showNotification('Product added to cart successfully!', true); // Changed to green notification
            closeProductDetailModal();
        } else {
            showNotification('Product is currently unavailable.');
        }
      });

      // Request order from product detail modal
      document.getElementById('modalRequestOrderBtn').addEventListener('click', function() {
        if (currentProduct) {
          showNotification(`Request sent for "${currentProduct.name}". We will contact you soon!`);
          closeProductDetailModal();
        }
      });

      // Cart modal functionality
      document.getElementById('cartBtn').addEventListener('click', function() {
        updateCartModal();
        const cartModal = document.getElementById('cartModal');
        cartModal.classList.remove('hidden');
        // Trigger animation by adding the final state class after a slight delay
        setTimeout(() => {
            cartModal.classList.remove('scale-95', 'opacity-0');
            cartModal.classList.add('scale-100', 'opacity-100');
        }, 10); // Small delay to allow 'hidden' to be removed first

        // Store current scroll position before opening modal
        previousScrollPosition = window.scrollY;
        history.pushState({ modal: 'cart', scrollY: previousScrollPosition }, '', '#cart'); // Add state for cart modal
      });

      document.getElementById('closeCart').addEventListener('click', function() {
        const cartModal = document.getElementById('cartModal');
        cartModal.classList.remove('scale-100', 'opacity-100');
        cartModal.classList.add('scale-95', 'opacity-0');
        // Hide the modal after the animation completes
        cartModal.addEventListener('transitionend', function handler() {
            cartModal.classList.add('hidden');
            cartModal.removeEventListener('transitionend', handler);
        }, { once: true });

        // Remove the modal state from history if it's the current state
        if (history.state && history.state.modal === 'cart') {
            history.back(); // Go back to the previous state
        }
      });

      // Proceed to Checkout button in Cart Modal
      document.getElementById('proceedToCheckoutBtn').addEventListener('click', function() {
        if (cart.length === 0) {
            showNotification('Your cart is empty. Please add products first.');
            return;
        }
        const cartModal = document.getElementById('cartModal');
        cartModal.classList.remove('scale-100', 'opacity-100');
        cartModal.classList.add('scale-95', 'opacity-0');
        cartModal.addEventListener('transitionend', function handler() {
            cartModal.classList.add('hidden');
            cartModal.removeEventListener('transitionend', handler);
            showPage('checkoutPage'); // Show checkout page after cart modal hides
            populateCheckoutSummary(); // Populate order summary
            history.pushState({ page: 'checkoutPage' }, '', '#checkoutPage'); // Add state for checkout page
        }, { once: true });
      });

      // Confirm Order button on Checkout Page
      document.getElementById('confirmOrderBtn').addEventListener('click', async function() { // Added async here
        const fullName = document.getElementById('fullName').value;
        const phone1 = document.getElementById('phone1').value;
        const phone2 = document.getElementById('phone2').value;
        const address = document.getElementById('address').value;

        // Validate required fields
        if (!fullName || !phone1 || !address) {
            showNotification('يرجى ملء جميع الحقول المطلوبة (الاسم الكامل، رقم الهاتف 1، العنوان).', false, true);
            return;
        }

        // Validate phone1 length
        if (phone1.length !== 11 || isNaN(phone1)) {
            showNotification('رقم الهاتف 1 يجب أن يتكون من 11 رقمًا فقط.', false, true);
            return;
        }

        // Validate phone2 length if provided
        if (phone2 && (phone2.length !== 11 || isNaN(phone2))) {
            showNotification('رقم الهاتف 2 يجب أن يتكون من 11 رقمًا فقط إذا تم إدخاله.', false, true);
            return;
        }

        let orderDetails = `✅ *طلب جديد من متجر مريام* ✅\n\n`;
        orderDetails += `*بيانات العميل:*\n`;
        orderDetails += `الاسم: ${fullName}\n`;
        orderDetails += `الهاتف 1: ${phone1}\n`;
        if (phone2) orderDetails += `الهاتف 2: ${phone2}\n`;
        orderDetails += `العنوان: ${address}\n\n`;
        orderDetails += `*المنتجات المطلوبة:*\n`;
        
        let totalOrderPrice = 0;
        cart.forEach((item, index) => {
            orderDetails += `${index + 1}. ${item.name} (${item.price} جنيه)\n`;
            if (item.size && item.size !== 'مقاس واحد') orderDetails += `   المقاس: ${item.size}\n`;
            if (item.color && item.color !== 'متعدد') orderDetails += `   اللون: ${item.color}\n`;
            totalOrderPrice += item.price;
        });
        orderDetails += `\n*المجموع الكلي: ${totalOrderPrice} جنيه*\n\n`;
        orderDetails += `_تم الطلب في: ${new Date().toLocaleString('ar-EG', { timeZone: 'Africa/Cairo' })}_`; // Added timestamp

        // Send order details to Telegram
        await sendTelegramMessage(orderDetails); // Await the message sending

        // Show success notification with two lines and animation
        showNotification('تم تأكيد طلبك بنجاح! سنتواصل معك قريباً.', true); 
        
        // Clear cart and redirect to home or thank you page
        cart = [];
        cartCount = 0;
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
        showPage('home'); // Go back to home page after order
        document.getElementById('checkoutForm').reset(); // Clear form
        history.replaceState({ page: 'home' }, '', '#home'); // Reset history state to home
      });


      // Wishlist button
      document.getElementById('wishlistBtn').addEventListener('click', function() {
        showPage('wishlist');
        history.pushState({ page: 'wishlist' }, '', '#wishlist'); // Add state for wishlist page
      });

      // Newsletter subscription
      document.querySelector('section:nth-last-child(2) button').addEventListener('click', function() {
        showNotification('You have successfully subscribed to the newsletter!');
      });
      
      // Load more products
      document.getElementById('loadMoreBtn').addEventListener('click', function() {
        showNotification('More products will be added soon!', false, false, 'text-red-500'); // Changed to red
      });

      // Image gallery controls
      document.getElementById('prevImageBtn').addEventListener('click', showPrevImage);
      document.getElementById('nextImageBtn').addEventListener('click', showNextImage);

      // Side Menu functionality
      document.getElementById('hamburgerBtn').addEventListener('click', openSideMenu);
      document.getElementById('closeSideMenu').addEventListener('click', closeSideMenu);
      document.getElementById('sideMenuOverlay').addEventListener('click', closeSideMenu);

      // NEW: Activate "All Products" button on page load
      const allProductsButton = document.querySelector('.filter-button[data-category="all"]');
      if (allProductsButton) {
        allProductsButton.click(); // Simulate a click to apply the filter and activate the button
      }

      // Handle browser back/forward button
      window.addEventListener('popstate', function(event) {
        const productDetailModal = document.getElementById('productDetailModal');
        const cartModal = document.getElementById('cartModal');
        const checkoutPage = document.getElementById('checkoutPage');
        const adminPanel = document.getElementById('adminPanel'); // New

        if (!productDetailModal.classList.contains('hidden')) {
            // If product detail modal is open, close it and restore scroll position
            closeProductDetailModal();
            if (event.state && event.state.scrollY !== undefined) {
                window.scrollTo(0, event.state.scrollY);
            }
        } else if (!cartModal.classList.contains('hidden')) {
            // If cart modal is open, close it with animation
            cartModal.classList.remove('scale-100', 'opacity-100');
            cartModal.classList.add('scale-95', 'opacity-0');
            cartModal.addEventListener('transitionend', function handler() {
                cartModal.classList.add('hidden');
                cartModal.removeEventListener('transitionend', handler);
            }, { once: true });
            if (event.state && event.state.scrollY !== undefined) {
                window.scrollTo(0, event.state.scrollY);
            }
        } else if (checkoutPage.classList.contains('active')) {
            // If on checkout page, go back to cart modal
            showPage('home'); // Hide checkout page by showing home
            const cartModal = document.getElementById('cartModal');
            cartModal.classList.remove('hidden');
            setTimeout(() => {
                cartModal.classList.remove('scale-95', 'opacity-0');
                cartModal.classList.add('scale-100', 'opacity-100');
            }, 10);
            history.pushState({ modal: 'cart', scrollY: previousScrollPosition }, '', '#cart'); // Manually push cart modal state back
        } else if (adminPanel.classList.contains('active')) { // New: Handle admin panel
            showPage('home'); // Go back to home from admin panel
            history.replaceState({ page: 'home' }, '', '#home');
        }
        else if (event.state && event.state.page) {
            // If there's a state, navigate to that page
            showPage(event.state.page);
            if (event.state.page === 'home') { // NEW: Re-initialize observer when returning to home
                initIntersectionObserver();
            }
            if (event.state.scrollY !== undefined) {
                window.scrollTo(0, event.state.scrollY);
            }
        } else {
            // Default to home if no specific state
            showPage('home');
            initIntersectionObserver(); // NEW: Re-initialize observer on initial home load
            history.replaceState({ page: 'home' }, '', '#home');
        }
      });

      // Initial page load check for hash
      const initialHash = window.location.hash.substring(1); // Remove the '#'
      if (initialHash && document.getElementById(initialHash)) {
          showPage(initialHash);
          if (initialHash === 'home') { // NEW: Re-initialize observer on initial home load
              initIntersectionObserver();
          }
          history.replaceState({ page: initialHash }, '', '#' + initialHash);
      } else {
          showPage('home');
          initIntersectionObserver(); // NEW: Re-initialize observer on initial home load
          history.replaceState({ page: 'home' }, '', '#home');
      }

      // Admin Panel Event Listeners (New)
      const productForm = document.getElementById('productForm');
      productForm.addEventListener('submit', handleProductFormSubmit);
      document.getElementById('clearFormBtn').addEventListener('click', clearProductForm);
      
      // NEW: Admin Login Button Listener
      document.getElementById('adminLoginBtn').addEventListener('click', handleAdminLogin);

      // Render admin products on load
      // Moved inside checkAdminLoginState for conditional rendering
      // renderAdminProducts(); 
    });

    // Function to scroll to products section
    function scrollToProducts() {
      const productsSection = document.getElementById('productsSection');
      if (productsSection) {
        productsSection.scrollIntoView({ behavior: 'smooth' });
      }
    }

    // Initialize add to cart event listeners
    function initAddToCartListeners() {
      document.querySelectorAll('.product-card').forEach(card => {
        const addToCartButton = card.querySelector('.add-to-cart');
        if (addToCartButton) {
          addToCartButton.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation(); // Prevent click from bubbling up to product card

            const productCard = this.closest('.product-card');
            const productAvailable = productCard.dataset.available === 'true';

            if (!productAvailable) {
              showNotification('This product is currently unavailable.');
              return;
            }
            
            const productSizes = productCard.dataset.sizes ? productCard.dataset.sizes.split(',') : [];
            const productColors = productCard.dataset.colors ? productCard.dataset.colors.split(',') : [];

            // Check if product truly requires options (not just 'مقاس واحد' أو 'متعدد')
            const requiresSizeSelection = productSizes.length > 0 && productSizes[0] !== 'مقاس واحد';
            const requiresColorSelection = productColors.length > 0 && productColors[0] !== 'متعدد';

            if (requiresSizeSelection || requiresColorSelection) {
              openProductDetailModal(productCard); // Open modal for selection
            } else {
              addProductToCartDirectly(productCard); // Add directly if no options needed
            }
          });
        }
      });
    }

    // Add product to cart directly
    function addProductToCartDirectly(productCard) {
      const productId = parseInt(productCard.dataset.id);
      const productData = productsData.find(p => p.id === productId);

      if (!productData) {
          showNotification('Product not found.', false, true);
          return;
      }

      const product = {
        name: productData.name,
        price: productData.price,
        image: productData.mainImage || (productData.images && productData.images.length > 0 ? productData.images[0] : ''), // Use mainImage or first image
        description: productData.description,
        size: 'مقاس واحد', // Default if no specific sizes
        color: 'متعدد', // Default if no specific colors
        colorImage: null, // No specific color image if no color selection
        id: Date.now() 
      };
      
      cart.push(product);
      cartCount++;
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartDisplay();
      
      const button = productCard.querySelector('.add-to-cart');
      button.classList.add('cart-badge');
      setTimeout(() => {
        button.classList.remove('cart-badge');
      }, 500);
      
      showNotification('Product added to cart successfully!', true); // Changed to green notification
    }

    // Open Product Detail Modal
    function openProductDetailModal(productCardElement) {
      const productId = parseInt(productCardElement.dataset.id);
      const product = productsData.find(p => p.id === productId);

      if (!product) {
          showNotification('Product details not found.', false, true);
          return;
      }

      currentProduct = product;

      // Reset selected options and image index
      selectedSize = null;
      selectedColor = null;
      currentImageIndex = 0; // Always start with the first image in the gallery

      document.getElementById('modalProductName').textContent = currentProduct.name;
      document.getElementById('modalProductDescription').textContent = currentProduct.description;
      document.getElementById('modalProductPrice').textContent = `${currentProduct.price} EGP`;

      const availabilityText = currentProduct.available && currentProduct.quantity > 0 ? 'Available' : 'Unavailable';
      const availabilityColor = currentProduct.available && currentProduct.quantity > 0 ? 'text-green-500' : 'text-red-500';
      document.getElementById('modalProductAvailability').textContent = availabilityText;
      document.getElementById('modalProductAvailability').className = `text-lg font-bold ${availabilityColor}`;

      // Populate sizes
      const sizesContainer = document.getElementById('sizesContainer');
      sizesContainer.innerHTML = '';
      const requiresSizeSelection = currentProduct.sizes.length > 0 && currentProduct.sizes[0] !== 'مقاس واحد';
      if (requiresSizeSelection) {
        document.getElementById('modalProductSizes').style.display = 'block';
        currentProduct.sizes.forEach(size => {
          const sizeBtn = document.createElement('button');
          sizeBtn.textContent = size;
          sizeBtn.className = 'px-4 py-2 border border-blue-200 rounded-full text-blue-400 hover:bg-blue-100 transition-colors';
          sizeBtn.addEventListener('click', () => {
            sizesContainer.querySelectorAll('button').forEach(btn => btn.classList.remove('option-selected'));
            sizeBtn.classList.add('option-selected');
            selectedSize = size;
            updateProductDetailModalButtons();
          });
          sizesContainer.appendChild(sizeBtn);
        });
      } else {
        document.getElementById('modalProductSizes').style.display = 'none';
      }

      // Populate colors
      const colorsContainer = document.getElementById('colorsContainer');
      colorsContainer.innerHTML = '';
      const requiresColorSelection = currentProduct.colors.length > 0 && currentProduct.colors[0] !== 'متعدد';
      if (requiresColorSelection) {
        document.getElementById('modalProductColors').style.display = 'block';
        currentProduct.colors.forEach(color => {
          const colorBtn = document.createElement('button');
          colorBtn.textContent = color;
          colorBtn.className = `color-option-btn transition-all duration-300 ease-in-out`; // Added transition
          colorBtn.dataset.color = color; // Store color for CSS styling

          // Set background color based on data-color attribute
          // This uses the CSS rules defined in the <style> block
          // For colors like 'أبيض' and 'بيج' that need dark text, handle it here
          if (color === 'أبيض' || color === 'بيج' || color === 'متعدد') {
            colorBtn.style.color = '#333'; // Dark text for light backgrounds
            colorBtn.style.borderColor = '#ccc'; // Light border for light backgrounds
          } else {
            colorBtn.style.color = 'white'; // White text for dark backgrounds
            colorBtn.style.borderColor = 'transparent'; // No border for dark backgrounds
          }
          // Apply the background color from the CSS variable or direct hex
          // A more robust solution would be to map colors to hex values in JS
          const colorMap = {
            "أسود": "#000",
            "رمادي": "#808080",
            "أزرق": "#0000FF",
            "أبيض": "#FFFFFF",
            "كحلي": "#000080",
            "بيج": "#F5F5DC",
            "أخضر": "#008000",
            "بني": "#A52A2A",
            "زيتي": "#6B8E23",
            "متعدد": "#ccc"
          };
          colorBtn.style.backgroundColor = colorMap[color] || '#ccc'; // Fallback to light gray

          colorBtn.addEventListener('click', () => {
            colorsContainer.querySelectorAll('button').forEach(btn => btn.classList.remove('option-selected'));
            colorBtn.classList.add('option-selected');
            selectedColor = color;
            // Update main image based on selected color
            if (currentProduct.colorImages && currentProduct.colorImages[selectedColor]) {
                document.getElementById('modalProductImage').src = currentProduct.colorImages[selectedColor];
                // Set currentImageIndex to -1 to indicate a color-specific image is shown, not from main gallery
                currentImageIndex = -1; 
                updateImageGalleryDisplay(); // Update gallery display to hide controls/thumbnails
            } else {
                // Fallback to main gallery if no specific color image
                currentImageIndex = 0; // Reset to first gallery image
                updateImageGalleryDisplay(); // Update gallery display to show controls/thumbnails
            }
            updateProductDetailModalButtons();
          });
          colorsContainer.appendChild(colorBtn);
        });
      } else {
        document.getElementById('modalProductColors').style.display = 'none';
      }

      // Initialize image gallery (always show initially)
      updateImageGalleryDisplay();
      populateThumbnails();

      updateProductDetailModalButtons();
      document.getElementById('productDetailModal').classList.remove('hidden');
      // Store current scroll position before opening modal
      previousScrollPosition = window.scrollY;
      history.pushState({ modal: 'productDetail', scrollY: previousScrollPosition }, '', '#productDetail'); // Add state for modal
    }

    function closeProductDetailModal() {
      document.getElementById('productDetailModal').classList.add('hidden');
      // Reset selected options when closing the modal
      selectedSize = null;
      selectedColor = null;
      // Remove 'option-selected' class from all size and color buttons
      document.querySelectorAll('#sizesContainer button').forEach(btn => btn.classList.remove('option-selected'));
      document.querySelectorAll('#colorsContainer button').forEach(btn => btn.classList.remove('option-selected'));

      // Remove the modal state from history if it's the current state
      if (history.state && history.state.modal === 'productDetail') {
          history.back(); // Go back to the previous state (e.g., home page)
      }
    }

    // New: Image Gallery Functions
    function updateImageGalleryDisplay() {
        const mainImage = document.getElementById('modalProductImage');
        const imageCounter = document.getElementById('imageCounter');
        const prevBtn = document.getElementById('prevImageBtn');
        const nextBtn = document.getElementById('nextImageBtn');
        const thumbnailsContainer = document.getElementById('galleryThumbnails');
        const galleryControls = document.querySelector('.product-gallery .gallery-controls'); // More specific selector

        // If a color-specific image is selected (currentImageIndex is -1), hide gallery controls and counter
        if (selectedColor && currentProduct.colorImages && currentProduct.colorImages[selectedColor]) {
            mainImage.src = currentProduct.colorImages[selectedColor];
            imageCounter.textContent = '';
            galleryControls.style.display = 'none';
            thumbnailsContainer.style.display = 'none'; // Hide thumbnails when a color-specific image is active
        } else if (currentProduct && currentProduct.images && currentProduct.images.length > 0) {
            // Otherwise, show gallery controls and counter for general images
            mainImage.src = currentProduct.images[currentImageIndex];
            imageCounter.textContent = `${currentImageIndex + 1} / ${currentProduct.images.length}`;
            
            // Show/hide gallery controls based on number of images
            if (currentProduct.images.length > 1) {
                galleryControls.style.display = 'flex';
                thumbnailsContainer.style.display = 'flex'; // Show thumbnails if multiple images
            } else {
                galleryControls.style.display = 'none';
                thumbnailsContainer.style.display = 'none';
            }
        } else {
            mainImage.src = ''; // Clear image if no images
            imageCounter.textContent = '';
            galleryControls.style.display = 'none';
            thumbnailsContainer.style.display = 'none';
        }

        // Update active thumbnail
        thumbnailsContainer.querySelectorAll('.thumbnail').forEach((thumb) => {
            thumb.classList.remove('active');
            if (currentImageIndex !== -1 && thumb.dataset.index === currentImageIndex.toString()) {
                thumb.classList.add('active');
            }
        });
    }

    function populateThumbnails() {
        const thumbnailsContainer = document.getElementById('galleryThumbnails');
        thumbnailsContainer.innerHTML = '';

        if (!currentProduct || !currentProduct.images || currentProduct.images.length === 0) {
            thumbnailsContainer.style.display = 'none';
            return;
        }

        // Only show thumbnails if there's more than one image
        if (currentProduct.images.length > 1) {
            thumbnailsContainer.style.display = 'flex'; 
            currentProduct.images.forEach((imageSrc, index) => {
                const thumbnail = document.createElement('img');
                thumbnail.src = imageSrc;
                thumbnail.className = 'thumbnail';
                thumbnail.alt = `Thumbnail ${index + 1}`;
                thumbnail.dataset.index = index; // Store original index
                thumbnail.addEventListener('click', () => {
                    currentImageIndex = index;
                    selectedColor = null; // Deselect color if a general image is chosen
                    document.getElementById('colorsContainer').querySelectorAll('button').forEach(btn => btn.classList.remove('option-selected')); // Remove color selection highlight
                    updateImageGalleryDisplay();
                });
                thumbnailsContainer.appendChild(thumbnail);
            });
        } else {
            thumbnailsContainer.style.display = 'none';
        }
        updateImageGalleryDisplay(); // Set initial active thumbnail
    }

    function showNextImage() {
        if (!currentProduct || !currentProduct.images || currentProduct.images.length === 0) return;
        currentImageIndex = (currentImageIndex + 1) % currentProduct.images.length;
        selectedColor = null; // Clear selected color when navigating general images
        document.getElementById('colorsContainer').querySelectorAll('button').forEach(btn => btn.classList.remove('option-selected'));
        updateImageGalleryDisplay();
        updateProductDetailModalButtons();
    }

    function showPrevImage() {
        if (!currentProduct || !currentProduct.images || currentProduct.images.length === 0) return;
        currentImageIndex = (currentImageIndex - 1 + currentProduct.images.length) % currentProduct.images.length;
        selectedColor = null; // Clear selected color when navigating general images
        document.getElementById('colorsContainer').querySelectorAll('button').forEach(btn => btn.classList.remove('option-selected'));
        updateImageGalleryDisplay();
        updateProductDetailModalButtons();
    }

    // Update buttons in product detail modal based on availability and selections
    function updateProductDetailModalButtons() {
      const addToCartBtn = document.getElementById('modalAddToCartBtn');
      const requestOrderBtn = document.getElementById('modalRequestOrderBtn');

      if (currentProduct.available && currentProduct.quantity > 0) {
        let disableAddToCart = false;
        let buttonText = 'Add to Cart';

        const requiresSizeSelection = currentProduct.sizes.length > 0 && currentProduct.sizes[0] !== 'مقاس واحد';
        const requiresColorSelection = currentProduct.colors.length > 0 && currentProduct.colors[0] !== 'متعدد';

        if (requiresSizeSelection && !selectedSize) {
            disableAddToCart = true;
            buttonText = 'Select Size First';
        } else if (requiresColorSelection && !selectedColor) {
            disableAddToCart = true;
            buttonText = 'Select Color First';
        }
        
        addToCartBtn.disabled = disableAddToCart;
        addToCartBtn.textContent = buttonText;
        if (disableAddToCart) {
            addToCartBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
            addToCartBtn.classList.remove('bg-blue-300', 'hover:bg-blue-400');
        } else {
            addToCartBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
            addToCartBtn.classList.add('bg-blue-300', 'hover:bg-blue-400');
        }
        requestOrderBtn.style.display = 'none';
      } else {
        addToCartBtn.disabled = true;
        addToCartBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
        addToCartBtn.classList.remove('bg-blue-300', 'hover:bg-blue-400');
        addToCartBtn.textContent = 'Out of Stock';
        requestOrderBtn.style.display = 'block';
      }
    }

    // Initialize filter buttons
    function initFilterButtons() {
      document.querySelectorAll('.filter-button').forEach(button => {
        button.addEventListener('click', function() {
          document.querySelectorAll('.filter-button').forEach(btn => {
            btn.classList.remove('active');
          });
          this.classList.add('active');
          
          const category = this.dataset.category;
          const products = document.querySelectorAll('.product-card');
          
          products.forEach(product => {
            if (category === 'all' || product.dataset.category === category) {
              product.style.display = 'block';
            } else {
              product.style.display = 'none';
            }
          });
        });
      });
    }

    // Wishlist functionality
    function toggleWishlist(heartIcon) {
      const productCard = heartIcon.closest('.product-card');
      const productId = parseInt(productCard.dataset.id);
      const productData = productsData.find(p => p.id === productId);

      if (!productData) {
          showNotification('Product not found.', false, true);
          return;
      }
      
      const product = {
        name: productData.name,
        price: productData.price,
        image: productData.mainImage || (productData.images && productData.images.length > 0 ? productData.images[0] : ''), // Use mainImage or first image
        description: productData.description,
        id: productData.id // Use product ID for wishlist
      };
      
      const existingIndex = wishlist.findIndex(item => item.id === product.id);
      
      if (existingIndex > -1) {
        wishlist.splice(existingIndex, 1);
        heartIcon.classList.remove('liked');
        showNotification('Product removed from wishlist.', false, true); // Red for removal
      } else {
        wishlist.push(product);
        heartIcon.classList.add('liked');
        showNotification('Product added to wishlist!', true); // Green for addition
      }
      
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
      wishlistCount = wishlist.length;
      updateWishlistDisplay();
      updateWishlistPage();
    }

    // Initialize wishlist items
    function initWishlistItems() {
      document.querySelectorAll('.heart-icon').forEach(heart => {
        const productCard = heart.closest('.product-card');
        const productId = parseInt(productCard.dataset.id);
        
        if (wishlist.some(item => item.id === productId)) {
          heart.classList.add('liked');
        } else {
          heart.classList.remove('liked'); // Ensure it's not liked if not in wishlist
        }
      });
    }

    // Update cart display
    function updateCartDisplay() {
      document.getElementById('cartCount').textContent = cartCount;
      updateCartModal();
    }

    // Update wishlist display
    function updateWishlistDisplay() {
      document.getElementById('wishlistCount').textContent = wishlistCount;
    }

    // Update cart modal
    function updateCartModal() {
      const cartItemsContainer = document.getElementById('cartItems');
      const cartTotal = document.getElementById('cartTotal');
      
      if (cart.length === 0) {
        cartItemsContainer.innerHTML = '<p class="text-blue-300 text-center">Your cart is empty</p>';
        cartTotal.textContent = '0 EGP';
        document.getElementById('proceedToCheckoutBtn').disabled = true;
        document.getElementById('proceedToCheckoutBtn').classList.add('bg-gray-400', 'cursor-not-allowed');
        document.getElementById('proceedToCheckoutBtn').classList.remove('bg-blue-300', 'hover:bg-blue-400');
        return;
      }
      
      cartItemsContainer.innerHTML = '';
      let total = 0;
      
      cart.forEach(item => {
        total += item.price;
        
        const cartItem = document.createElement('div');
        cartItem.className = 'flex items-center justify-between p-4 border border-blue-100 rounded-lg';
        cartItem.innerHTML = `
          <div class="flex items-center space-x-4 space-x-reverse">
            <img src="${item.colorImage || item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded" />
            <div>
              <h4 class="font-semibold">${item.name}</h4>
              <p>${item.price} EGP</p>
              ${item.size && item.size !== 'مقاس واحد' ? `<p class="text-xs">Size: ${item.size}</p>` : ''}
              ${item.color && item.color !== 'متعدد' ? `<p class="text-xs">Color: ${item.color}</p>` : ''}
            </div>
          </div>
          <button onclick="removeFromCart(${item.id})" class="text-blue-300 hover:text-blue-400">
            <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
            </svg>
          </button>
        `;
        cartItemsContainer.appendChild(cartItem);
      });
      
      cartTotal.textContent = `${total} EGP`;
      document.getElementById('proceedToCheckoutBtn').disabled = false;
      document.getElementById('proceedToCheckoutBtn').classList.remove('bg-gray-400', 'cursor-not-allowed');
      document.getElementById('proceedToCheckoutBtn').classList.add('bg-blue-300', 'hover:bg-blue-400');
    }

    // Update wishlist page
    function updateWishlistPage() {
      const wishlistGrid = document.getElementById('wishlistGrid');
      const emptyWishlist = document.getElementById('emptyWishlist');
      
      if (wishlist.length === 0) {
        wishlistGrid.style.display = 'none';
        emptyWishlist.style.display = 'block';
        return;
      }
      
      wishlistGrid.style.display = 'grid';
      emptyWishlist.style.display = 'none';
      wishlistGrid.innerHTML = '';
      
      wishlist.forEach(item => {
        const wishlistItem = document.createElement('div');
        wishlistItem.className = 'bg-white rounded-xl shadow-lg overflow-hidden card-hover';
        wishlistItem.innerHTML = `
          <div class="relative">
            <img src="${item.image}" alt="${item.description}" class="w-full h-64 object-cover product-image" />
            <button class="absolute top-4 right-4 p-2 bg-white rounded-full heart-icon liked" onclick="removeFromWishlist('${item.id}')">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
              </svg>
            </button>
          </div>
          <div class="p-6">
            <h3 class="text-lg font-semibold text-blue-400 mb-2">${item.name}</h3>
            <p class="product-description">${item.description}</p>
            <div class="flex justify-between items-center">
              <span class="text-xl font-bold text-blue-400">${item.price} EGP</span>
              <button onclick="addToCartFromWishlist('${item.id}')" class="bg-blue-300 text-white px-4 py-2 rounded-full hover:bg-blue-400 transition-colors animated-button">
                Add to Cart
              </button>
            </div>
          </div>
        `;
        wishlistGrid.appendChild(wishlistItem);
      });
    }

    // Remove from cart
    function removeFromCart(id) {
      cart = cart.filter(item => item.id !== id);
      cartCount = cart.length;
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartDisplay();
      populateCheckoutSummary(); // Update checkout summary if on that page
      showNotification('Product removed from cart.', false, true); // Red for removal
    }

    // Remove from wishlist
    function removeFromWishlist(id) {
      wishlist = wishlist.filter(item => item.id !== id);
      wishlistCount = wishlist.length;
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
      updateWishlistDisplay();
      updateWishlistPage();
      showNotification('Product removed from wishlist.', false, true); // Red for removal
    }

    // Add to cart from wishlist
    function addToCartFromWishlist(id) {
      const item = wishlist.find(item => item.id === id);
      
      if (item) {
        const cartItem = {
          ...item,
          id: Date.now()
        };
        
        cart.push(cartItem);
        cartCount++;
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
        showNotification('Product added to cart successfully!', true); // Changed to green notification
      }
    }

    // Populate Checkout Order Summary
    function populateCheckoutSummary() {
        const summaryContainer = document.getElementById('checkoutOrderSummary');
        const totalElement = document.getElementById('checkoutTotal').querySelector('span:last-child');
        let total = 0;

        summaryContainer.innerHTML = ''; // Clear previous items

        if (cart.length === 0) {
            summaryContainer.innerHTML = '<p class="text-blue-300 text-center">لا توجد منتجات في السلة.</p>';
            totalElement.textContent = '0 جنيه';
            return;
        }

        cart.forEach(item => {
            total += item.price;
            const itemDiv = document.createElement('div');
            itemDiv.className = 'order-summary-item';
            itemDiv.innerHTML = `
                <img src="${item.colorImage || item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded" />
                <div class="order-summary-item-details">
                    <h4>${item.name}</h4>
                    <p>${item.price} جنيه</p>
                    ${item.size && item.size !== 'مقاس واحد' ? `<p class="text-xs">المقاس: ${item.size}</p>` : ''}
                    ${item.color && item.color !== 'متعدد' ? `<p class="text-xs">اللون: ${item.color}</p>` : ''}
                </div>
                <button onclick="removeFromCart(${item.id})" class="text-blue-300 hover:text-blue-400">
                    <svg class="w-5 h-5" fill="none", stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round", stroke-linejoin="round", stroke-width="2", d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                </button>
            `;
            summaryContainer.appendChild(itemDiv);
        });

        totalElement.textContent = `${total} جنيه`;
    }

    // Show notification function (modified)
    function showNotification(message, isSuccess = false, isError = false, customTextColorClass = '') {
      const notificationContainer = document.querySelector('.notification-container') || (() => {
        const div = document.createElement('div');
        div.className = 'notification-container';
        document.body.appendChild(div);
        return div;
      })();

      const notificationItem = document.createElement('div');
      notificationItem.className = 'notification-item';

      if (isSuccess) {
        notificationItem.innerHTML = `
          <div class="main-message">${message}</div>
          <div class="sub-message">Thank you for shopping with us!</div>
        `;
        // Set background color to green for success messages
        notificationItem.style.backgroundColor = '#28a745'; 
      } else if (isError) {
        notificationItem.classList.add('error'); // Add class for error messages
        notificationItem.textContent = message;
        // Set background color to red for error messages
        notificationItem.style.backgroundColor = '#dc3545';
      }
      else {
        notificationItem.classList.add('regular'); // Add class for regular messages
        notificationItem.textContent = message;
        // Set background color to dark gray for regular messages
        notificationItem.style.backgroundColor = '#333333'; 
      }

      if (customTextColorClass) {
          notificationItem.classList.add(customTextColorClass);
      }
      
      notificationContainer.appendChild(notificationItem);

      // Show animation
      setTimeout(() => {
        notificationItem.classList.add('show');
      }, 10);

      // Hide and remove after 1 second for specific messages, 4 seconds for others
      const duration = (message === 'Product added to wishlist!' || 
                        message === 'Product removed from wishlist.' ||
                        message === 'Product removed from cart.' ||
                        message === 'Product added to cart successfully!' ||
                        message === 'تم تأكيد طلبك بنجاح! سنتواصل معك قريباً.') ? 1000 : 4000;

      setTimeout(() => {
        notificationItem.classList.remove('show');
        notificationItem.classList.add('hide');
        notificationItem.addEventListener('transitionend', () => {
          notificationItem.remove();
        }, { once: true });
      }, duration);
    }

    // ** Function to send message to Telegram **
    async function sendTelegramMessage(message) {
        const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
        const params = {
            chat_id: TELEGRAM_CHAT_ID,
            text: message,
            parse_mode: 'Markdown' // Use Markdown for bold text etc.
        };

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(params)
            });

            const data = await response.json();
            if (data.ok) {
                console.log('Message sent to Telegram successfully:', data);
            } else {
                console.error('Failed to send message to Telegram:', data);
                // Log the error details from Telegram API for debugging
                console.error('Telegram API Error:', data.description); 
                showNotification('فشل إرسال الطلب إلى التليجرام. يرجى المحاولة مرة أخرى.');
            }
        } catch (error) {
            console.error('Error sending message to Telegram:', error);
            showNotification('حدث خطأ أثناء الاتصال بخدمة التليجرام.');
        }
    }

    // Side Menu Functions
    function openSideMenu() {
      document.getElementById('sideMenu').classList.add('open');
      document.getElementById('sideMenuOverlay').classList.add('open');
      document.body.style.overflow = 'hidden'; // Prevent scrolling body
    }

    function closeSideMenu() {
      document.getElementById('sideMenu').classList.remove('open');
      document.getElementById('sideMenuOverlay').classList.remove('open');
      document.body.style.overflow = ''; // Allow scrolling body
    }

    // Admin Panel Functions (New)
    function renderAdminProducts() {
        const tableBody = document.getElementById('adminProductsTableBody');
        tableBody.innerHTML = ''; // Clear existing rows

        productsData.forEach(product => {
            const row = tableBody.insertRow();
            row.innerHTML = `
                <td>${product.id}</td>
                <td>${product.name}</td>
                <td>${product.price} EGP</td>
                <td>${product.category}</td>
                <td>${product.quantity}</td>
                <td>${product.available ? 'نعم' : 'لا'}</td>
                <td>
                    <button onclick="editProduct(${product.id})" class="admin-btn text-sm py-1 px-2">تعديل</button>
                    <button onclick="deleteProduct(${product.id})" class="admin-btn admin-btn-danger text-sm py-1 px-2">حذف</button>
                </td>
            `;
        });
    }

    function saveProductsToLocalStorage() {
        localStorage.setItem('productsData', JSON.stringify(productsData));
    }

    function handleProductFormSubmit(event) {
        event.preventDefault();

        const productId = document.getElementById('productId').value;
        const name = document.getElementById('productName').value;
        const price = parseFloat(document.getElementById('productPrice').value);
        const description = document.getElementById('productDescription').value;
        const category = document.getElementById('productCategory').value;
        const mainImage = document.getElementById('productMainImage').value; 
        
        // Split by comma, trim whitespace, and filter out empty strings
        const sizes = document.getElementById('productSizes').value.split(',').map(s => s.trim()).filter(s => s !== '');
        const colors = document.getElementById('productColors').value.split(',').map(c => c.trim()).filter(c => c !== '');
        
        // Parse images as an array
        let images = [];
        try {
            const imagesInput = document.getElementById('productImages').value;
            if (imagesInput) {
                images = imagesInput.split(',').map(img => img.trim()).filter(img => img !== '');
            }
        } catch (e) {
            showNotification('صيغة روابط صور المعرض غير صحيحة (يجب أن تكون مفصولة بفاصلة).', false, true);
            return;
        }

        const quantity = parseInt(document.getElementById('productQuantity').value);
        const available = document.getElementById('productAvailable').checked;
        let colorImages = {};
        try {
            const colorImagesInput = document.getElementById('productColorImages').value;
            if (colorImagesInput) {
                colorImages = JSON.parse(colorImagesInput);
            }
        } catch (e) {
            showNotification('صيغة روابط صور الألوان غير صحيحة (يجب أن تكون JSON).', false, true);
            return;
        }

        if (productId) {
            // Edit existing product
            const index = productsData.findIndex(p => p.id === parseInt(productId));
            if (index !== -1) {
                productsData[index] = {
                    id: parseInt(productId),
                    name,
                    price,
                    description,
                    category,
                    sizes,
                    colors,
                    mainImage, 
                    images,
                    colorImages,
                    quantity,
                    available
                };
                showNotification('تم تعديل المنتج بنجاح!', true);
            } else {
                showNotification('المنتج غير موجود.', false, true);
            }
        } else {
            // Add new product
            const newId = productsData.length > 0 ? Math.max(...productsData.map(p => p.id)) + 1 : 1;
            const newProduct = {
                id: newId,
                name,
                price,
                description,
                category,
                sizes,
                colors,
                mainImage, 
                images,
                colorImages,
                quantity,
                available
            };
            productsData.push(newProduct);
            showNotification('تم إضافة المنتج بنجاح!', true);
        }

        saveProductsToLocalStorage(); // Save changes to localStorage
        renderAdminProducts(); // Update admin table
        renderProducts(); // Re-render products on main page to reflect changes
        initIntersectionObserver(); // Re-initialize observer after rendering new products
        clearProductForm();
    }

    function editProduct(id) {
        const product = productsData.find(p => p.id === id);
        if (product) {
            document.getElementById('productId').value = product.id;
            document.getElementById('productName').value = product.name;
            document.getElementById('productPrice').value = product.price;
            document.getElementById('productDescription').value = product.description;
            document.getElementById('productCategory').value = product.category;
            document.getElementById('productSizes').value = product.sizes.join(',');
            document.getElementById('productColors').value = product.colors.join(',');
            document.getElementById('productMainImage').value = product.mainImage || ''; 
            document.getElementById('productImages').value = product.images.join(',');
            // Ensure colorImages is stringified when setting the textarea value
            document.getElementById('productColorImages').value = JSON.stringify(product.colorImages);
            document.getElementById('productQuantity').value = product.quantity;
            document.getElementById('productAvailable').checked = product.available;
            showNotification('تم تحميل بيانات المنتج للتعديل.', false);
        } else {
            showNotification('المنتج غير موجود.', false, true);
        }
    }

    function deleteProduct(id) {
        if (confirm('هل أنت متأكد أنك تريد حذف هذا المنتج؟')) {
            productsData = productsData.filter(p => p.id !== id);
            saveProductsToLocalStorage(); // Save changes to localStorage
            renderAdminProducts(); // Update admin table
            renderProducts(); // Re-render products on main page to reflect changes
            initIntersectionObserver(); // Re-initialize observer after rendering new products
            showNotification('تم حذف المنتج بنجاح!', true);
        }
    }

    function clearProductForm() {
        document.getElementById('productId').value = '';
        document.getElementById('productForm').reset();
        document.getElementById('productAvailable').checked = true; // Default to available
        showNotification('تم مسح النموذج.', false);
    }

    // Three.js Integration (kept for reference, but not actively used in hero section)
    let scene, camera, renderer, cube;

    function initThreeJS() {
        const container = document.getElementById('threejs-container');
        if (!container) return;

        // Scene
        scene = new THREE.Scene();

        // Camera
        camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.z = 2;

        // Renderer
        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true }); // alpha: true for transparent background
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        // Geometry
        const geometry = new THREE.BoxGeometry(1, 1, 1);

        // Material (using a simple color for lightness)
        const material = new THREE.MeshBasicMaterial({ color: 0x000000 }); // Black color

        // Mesh
        cube = new THREE.Mesh(geometry, material);
        scene.add(cube);

        // Animation Loop
        function animate() {
            requestAnimationFrame(animate);

            cube.rotation.x += 0.005; // Slower rotation
            cube.rotation.y += 0.005; // Slower rotation

            renderer.render(scene, camera);
        }

        animate();

        // Handle window resize
        window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize() {
        const container = document.getElementById('threejs-container');
        if (!container) return;

        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
    }
  </script>
</body>
</html>
